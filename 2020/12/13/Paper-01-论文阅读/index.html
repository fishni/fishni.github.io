<!DOCTYPE html>
<html>
<head hexo-theme='https://volantis.js.org/#'>
  <meta charset="utf-8">
  <!-- SEO相关 -->
  
    
  
  <!-- 渲染优化 -->
  <meta name="renderer" content="webkit">
  <meta name="force-rendering" content="webkit">
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
  <meta name="HandheldFriendly" content="True" >
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <!-- 页面元数据 -->
  
    <title>【PapersReading】通过被动DNS流量分析识别大规模IoT设备 - fishni</title>
  
    <meta name="keywords" content="PapersReading">
  
  
    <meta name="description" content="见下文。">
  

  <!-- feed -->
  

  <!-- import meta -->
  

  <!-- link -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.12.1/css/all.min.css">
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css">

  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-waves@0.7.6/dist/waves.min.css">

  

  
  <link rel="shortcut icon" type='image/x-icon' href="https://cdn.jsdelivr.net/gh/xaoxuu/assets@master/favicon/favicon.ico">
  

  

  <!-- import link -->
  

  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-volantis@2.2.1/css/style.css">

  

  <script>
    function setLoadingBarProgress(num) {
      document.getElementById('loading-bar').style.width=num+"%";
    }
  </script>

  
  
</head>

<body>
  
  <div id="loading-bar-wrapper">
  <div id="loading-bar"></div>
</div>
<header class="l_header shadow blur">

  <div class='wrapper'>
    <div class='nav-sub'>
      <a class="logo flat-box"></a>
      <ul class='switcher h-list'>
        <li><a class="s-comment flat-btn fas fa-comments fa-fw" target="_self" href='javascript:void(0)'></a></li>
        
          <li><a class="s-toc flat-btn fas fa-list fa-fw" target="_self" href='javascript:void(0)'></a></li>
        
      </ul>
    </div>
		<div class="nav-main">
      
        
        <a class="logo flat-box" target="_self" href='/'>
          
          
          
          
            FISHNI'S BLOG <b><sup style='color:#3AA757'></sup></b>
          
        </a>
      

      

			<div class='menu navigation'>
				<ul class='h-list'>
          
          
          
            
            
              <li>
                <a class="flat-box" href=/
                  
                  
                  
                    id="home"
                  >
                  
                    <i class='fas fa-rss fa-fw'></i>
                  
                  主页
                </a>
                
              </li>
            
          
          
            
            
              <li>
                <a class="flat-box" href=/categories/
                  
                  
                  
                    id="categories"
                  >
                  
                    <i class='fas fa-folder-open fa-fw'></i>
                  
                  分类
                </a>
                
              </li>
            
          
          
            
            
              <li>
                <a class="flat-box" href=/tags/
                  
                  
                  
                    id="tags"
                  >
                  
                    <i class='fas fa-tags fa-fw'></i>
                  
                  标签
                </a>
                
              </li>
            
          
          
            
            
              <li>
                <a class="flat-box" href=/archives/
                  
                  
                  
                    id="archives"
                  >
                  
                    <i class='fas fa-archive fa-fw'></i>
                  
                  归档
                </a>
                
              </li>
            
          
          
            
            
              <li>
                <a class="flat-box" href=/
                  
                  
                  
                    id="home"
                  >
                  
                    <i class='fas fa-info-circle fa-fw'></i>
                  
                  更多
                </a>
                
              </li>
            
          
          
				</ul>
			</div>

      
        <div class="m_search">
          <form name="searchform" class="form u-search-form">
            <i class="icon fas fa-search fa-fw"></i>
            <input type="text" class="input u-search-input" placeholder="搜索" />
          </form>
        </div>
      

			<ul class='switcher h-list'>
				
					<li><a class="s-search flat-btn fas fa-search fa-fw" target="_self" href='javascript:void(0)'></a></li>
				
				<li><a class="s-menu flat-btn fas fa-bars fa-fw" target="_self" href='javascript:void(0)'></a></li>
			</ul>
		</div>
	</div>
</header>
<ul class="menu-phone navigation white-box">
  
  
    <li>
      <a class="flat-box" href=/
        
        
        
          id="home"
        >
        
          <i class='fas fa-rss fa-fw'></i>
        
        主页
      </a>
    </li>
  
    <li>
      <a class="flat-box" href=/categories/
        
        
        
          id="categories"
        >
        
          <i class='fas fa-folder-open fa-fw'></i>
        
        分类
      </a>
    </li>
  
    <li>
      <a class="flat-box" href=/tags/
        
        
        
          id="tags"
        >
        
          <i class='fas fa-tags fa-fw'></i>
        
        标签
      </a>
    </li>
  
    <li>
      <a class="flat-box" href=/archives/
        
        
        
          id="archives"
        >
        
          <i class='fas fa-archive fa-fw'></i>
        
        归档
      </a>
    </li>
  
</ul>
<script>setLoadingBarProgress(40);</script>



  <div class="l_body nocover">
    <div class='body-wrapper'>
      

<div class='l_main'>
  

  
    <article id="post" class="post white-box shadow article-type-post" itemscope itemprop="blogPost">
      


  <section class='meta'>
    
    
    <div class="meta" id="header-meta">
      
        
  
    <h1 class="title">
      <a href="/2020/12/13/Paper-01-%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB/">
        【PapersReading】通过被动DNS流量分析识别大规模IoT设备
      </a>
    </h1>
  


      
      <div class='new-meta-box'>
        
          
        
          
            
<div class='new-meta-item author'>
  <a href="https://fishni.github.io/" rel="nofollow">
    <img src="https://cdn.jsdelivr.net/gh/fishni/ImgHosting/Images/A01/ghost1.jpg">
    <p>fishni</p>
  </a>
</div>

          
        
          
            
  
  <div class='new-meta-item category'>
    <a href='/categories/PapersReading/' rel="nofollow">
      <i class="fas fa-folder-open fa-fw" aria-hidden="true"></i>
      <p>PapersReading</p>
    </a>
  </div>


          
        
          
            <div class="new-meta-item date">
  <a class='notlink'>
    <i class="fas fa-calendar-alt fa-fw" aria-hidden="true"></i>
    <p>发布于：2020年12月13日</p>
  </a>
</div>

          
        
          
            

          
        
      </div>
      
        <hr>
      
    </div>
  </section>


      <section class="article typo">
        <div class="article-entry" itemprop="articleBody">
          
          <p>见下文。</p>
<a id="more"></a>

<h2 id="论文"><a href="#论文" class="headerlink" title="论文"></a>论文</h2><p><a href="2-IoTFinder-ESP20.pdf">IoTFinder: Efficient Large-Scale Identification of IoT Devices via Passive DNS Traffic Analysis</a></p>
<p> September 7-11, 2020 (all-digital event)<br>5th IEEE European Symposium on Security and Privacy</p>
<p>这是一篇S&amp;P上收录的论文</p>
<h2 id="论文摘要"><a href="#论文摘要" class="headerlink" title="论文摘要"></a>论文摘要</h2><ul>
<li>本文要解决问题</li>
</ul>
<p>识别潜在的易受攻击的IoT设备</p>
<ul>
<li>解决方案</li>
</ul>
<p>提出一个IoTFinder系统，通过被动DNS流量分析，能够大规模、高效的识别IoT设备</p>
<ul>
<li><p>数据收集：收集分布式被动DNS数据</p>
</li>
<li><p>该系统基于机器学习</p>
</li>
<li><p>仅基于DNS指纹识别IoT设备</p>
</li>
<li><p>识别的广泛性：该系统不论IoT设备处于NAT下，其他中间盒、还是分配了IP4或IP6地址，也能进行识别</p>
</li>
<li><p>IoTFinder</p>
<ul>
<li>多标签分类器</li>
<li>本文通过不同设置评估了其分类的准确性<ul>
<li>不同的DNS流量数据</li>
</ul>
</li>
<li>实验结果表明，即使将它们托管在NAT之后并且其流量与由同一本地网络中托管的其他IoT和非IoT设备生成的流量“混合”在一起，我们的方法也可以准确地检测许多不同的IoT设备。</li>
</ul>
</li>
</ul>
<p>本文主要关于：</p>
<p>   IoT安全</p>
<p>   流量模型</p>
<p>   被动DNS</p>
<h3 id="B相关知识学习"><a href="#B相关知识学习" class="headerlink" title="B相关知识学习"></a>B相关知识学习</h3><h4 id="被动DNS（Passive-DNS）"><a href="#被动DNS（Passive-DNS）" class="headerlink" title="被动DNS（Passive DNS）"></a>被动DNS（Passive DNS）</h4><p><a href="https://developer.aliyun.com/article/764940" target="_blank" rel="noopener">https://developer.aliyun.com/article/764940</a></p>
<p><a href="https://securitytrails.com/blog/passive-dns" target="_blank" rel="noopener">https://securitytrails.com/blog/passive-dns</a></p>
<p><a href="https://xz.aliyun.com/t/5991" target="_blank" rel="noopener">https://xz.aliyun.com/t/5991</a></p>
<ul>
<li><p>DNS：域名与IP地址相互映射的分布式数据库</p>
</li>
<li><p>域名解析：通过域名获取IP地址的过程</p>
</li>
<li><p>被动DNS:</p>
<blockquote>
<ul>
<li>与传统的DNS（实时系统需要查询DNS服务器和解析器以将主机名转换为IP地址）不同，被动DNS的工作方式却相反。<br>这意味着始终存在一个DNS数据库，用于存储DNS记录，IP地址查找以及有关与通用DNS通信中涉及的域，服务器和IP地址有关的所有内容的统计信息。此信息将保存在安全的数据库中，以供以后分析，该数据库会将实时DNS结果转换为被动DNS数据。</li>
<li>顾名思义，也即通过被动获取DNS数据（在互联网中，通过流量抓取工具获取DNS数据），这些数据被存储到一个中央安全数据库，形式Passive DNS。这种数据信息和一些本地DNS数据不同的是，它包含的不仅是当前的DNS数据（包括IP映射等），还包括了历史上所存在的一些DNS数据映射等。比如，一个域名在某个时间段内可以解析到多个IP地址上，一个IP地址也可以某个时间段内映射在多个域名，这些映射历史都是可以被Passive DNS数据包含在内，这样研究者可以从这些关联数据中发现已知的恶意域名与未知恶意域名之间的关系，从而挖掘出未知的威胁风险。</li>
</ul>
</blockquote>
</li>
</ul>
<ul>
<li><p>Passive DNS应用场景</p>
<p>  检测网站钓鱼域名<br>  阻断垃圾邮件干扰<br>  识别恶意域名<br>  提供威胁情报<br>  检测域名劫持<br>  品牌保护<br>  域名DNS历史记录查询<br>  查询主域名下的所有子域名</p>
</li>
<li><p>被动DNS工作原理</p>
</li>
</ul>
<p>通过实例简单了解</p>
<p>以下实例，使用到的是美国Farsight Security公司推出的Passive DNS数据库—-DNSDB，有关这一案例的更多信息，可参考该公司的Passive DNS白皮书：<a href="https://info.farsightsecurity.com/passive-dns-ebook" target="_blank" rel="noopener">https://info.farsightsecurity.com/passive-dns-ebook</a></p>
<img src="https://cdn.jsdelivr.net/gh/fishni/ImgHosting/Images/A01/201213paper01.png" width="500px">

<h2 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h2><ul>
<li><p>面临挑战</p>
<p>  传统通过banner grabbing  和fingerprinting 能够识别暴露网络服务的设备包括IoT设备，</p>
<p>  但是当IoT设备托管在NAT或者其他中间盒后（防火墙），主动探测不能够识别IoT设备</p>
<p>  当IoT设备被分配IPv6地址时，识别也面临挑战</p>
</li>
</ul>
<h3 id="B相关知识学习-1"><a href="#B相关知识学习-1" class="headerlink" title="B相关知识学习"></a>B相关知识学习</h3><h4 id="banner-grabbing（横幅抓取）"><a href="#banner-grabbing（横幅抓取）" class="headerlink" title="banner grabbing（横幅抓取）"></a>banner grabbing（横幅抓取）</h4><p><a href="https://securitytrails.com/blog/banner-grabbing" target="_blank" rel="noopener">https://securitytrails.com/blog/banner-grabbing</a></p>
<p>横幅抓取是一种用于确定远程计算机上正在运行的服务的信息的活动</p>
<p>在渗透测试或安全审核期间，无论何时执行智能侦察过程，我们都需要注意当前Web服务器的公开信息。</p>
<p> 这就是banner grabbing的来源。banner grabbing是获取软件横幅信息（名称和版本）的一种方法，无论是手动完成的，还是使用任何可自动为您完成的OSINT工具。</p>
<p> FTP服务器，Web服务器，SSH服务器和其他系统守护程序通常会公开重要信息，这些信息不仅涉及软件名称，而且还涉及它们所运行的确切版本和操作系统（相关的“横幅”数据）。</p>
<p> 在匹配关键CVE的情况下，对任何协议进行抢夺式攻击都可能发现不安全和易受攻击的应用程序，这可能导致服务利用和损害。</p>
<p> 您如何进行标语抢夺攻击？ 只需选择您要定位的服务，启动请求，检查收到的响应即可。</p>
<h4 id="fingerprinting-指纹"><a href="#fingerprinting-指纹" class="headerlink" title="fingerprinting(指纹)"></a>fingerprinting(指纹)</h4><p><a href="https://securitytrails.com/blog/cybersecurity-fingerprinting" target="_blank" rel="noopener">https://securitytrails.com/blog/cybersecurity-fingerprinting</a></p>
<p>物理世界，指纹通常唯一标识单个个体，分析指纹是用于识别与所有类型的犯罪活动有关的最流行的技术之一，从抢劫到绑架甚至是谋杀。</p>
<p>在数字世界中，也有分析指纹的方法，但是从这个意义上讲，我们是在谈论操作系统，网络和服务指纹。</p>
<p>网络安全中的指纹</p>
<blockquote>
<ul>
<li>数字世界中的指纹与现实世界中的人类指纹相似。简而言之，指纹是可以用来检测软件，网络协议，操作系统或硬件设备的一组信息。</li>
<li><strong>指纹（也称为足迹）</strong>是一种使用该信息将数据集关联起来的技术，以便以较高的可能性识别网络服务，操作系统编号和版本，软件应用程序，数据库，配置等。</li>
<li>一旦渗透测试人员获得足够的信息，此指纹数据就可以用作针对目标的利用策略的一部分</li>
</ul>
</blockquote>
<h3 id="IoTFinder设计期望"><a href="#IoTFinder设计期望" class="headerlink" title="IoTFinder设计期望"></a>IoTFinder设计期望</h3><ul>
<li><p>Fully-automated fingerprint learning（全自动指纹学习）</p>
</li>
<li><p>One fingerprint per IoT device（每个物联网设备一个指纹）</p>
<ul>
<li><p>给一个DNS流量跟踪D，从Ik设备学习得到一个指纹fk，利用fk作为二分类判断Ik是否产生或者有贡献于在D中看到DNS活动</p>
</li>
<li><p>multi-label classification</p>
<p>与多类别分类方法不同，这些单独的指纹使我们可以轻松地执行多标签分类，从而可以识别可能在同一（NAT）IP地址后共同托管的多个不同的物联网设备</p>
</li>
</ul>
</li>
<li><p>在混合网络流量中准确识别IoT设备</p>
</li>
<li><p>结果可解释</p>
</li>
<li><p>有效的匹配</p>
</li>
</ul>
<h3 id="本文贡献"><a href="#本文贡献" class="headerlink" title="本文贡献"></a>本文贡献</h3><ul>
<li>提出了IoTFinder系统，可有效大规模检测IoT设备。其旨在自动从真实IoT设备中学习统计DNS流量指纹，并对地理位置不同的网络位置收集的大量DNS流量上进行有效的匹配来源指纹。</li>
<li>IoTFinder用作多标签分类器，即IoT设备位于NAT后面，并且其流量与由同一本地网络中托管的其他IoT和非IoT设备生成的流量“混合”，也能够检测到IoT设备。</li>
<li>为了评估统计模型的准确性，我们在几种不同的设置下对我们的IoT指纹进行了详细评估，包括通过第三方IoT流量数据集计算检测结果。 这些详细的实验使我们能够突出提出的方法的优点，并指出可能的局限性</li>
<li>我们还将物联网指纹应用于在美国的ISP收集的DNS流量上，该ISP托管了超过4000万客户，以评估我们系统的性能。 我们的结果表明，我们可以在有限的时间内（略大于一小时）有效地处理一整天的ISP级DNS流量，并测试所有IoT指纹。</li>
</ul>
<h2 id="直觉和方法概述"><a href="#直觉和方法概述" class="headerlink" title="直觉和方法概述"></a>直觉和方法概述</h2><h3 id="IoT数据收集"><a href="#IoT数据收集" class="headerlink" title="IoT数据收集"></a>IoT数据收集</h3><p>建立大型物联网实验室，包括多个语音助手、摄像头等53台来自不同供应商的活动IoT设备。这些设备部署在人参与的实验室中。本文特别关注IoT设备<br>生成的DNS流量，实验中使用的IoT DNS数据集跨越1.5个月。</p>
<img src="https://cdn.jsdelivr.net/gh/fishni/ImgHosting/Images/A01/201213paper02.png" width="500px">

<h3 id="激励的示例"><a href="#激励的示例" class="headerlink" title="激励的示例"></a>激励的示例</h3><img src="https://cdn.jsdelivr.net/gh/fishni/ImgHosting/Images/A01/201213paper03.png" width="500px">

<p>上图表示，24个小时内部分IoT设备查询域名的情况，</p>
<p>水平表示每个IoT设备查询的域名，</p>
<p>垂直代表一个小时的窗口，</p>
<p>原点表示DNS查询的次数</p>
<ul>
<li><p>基于IoT设备产生的DNS活动构建简单探测模型</p>
<p>  文献【19】提出类似模型：给定特定IoT设备的查询的一组域和从第三方网络收集的被动DNS跟踪，如果跟踪中DNS客户端（例有匿名ID或IP地址标识）查询的域名在特定IoT设备查询域中，就将该客户端的IP（或匿名ID）标记为IoT设备托管在其下。</p>
<ul>
<li>此模型问题<ul>
<li>容易产生大量误报</li>
<li>易通过探测域（该域是否包含人类可访问内容）过滤掉一些域名，从而会丢弃一些信息，降低潜在的分类能力</li>
<li>也会丢弃不包含供应商名称或设备型号名称的域名</li>
<li>使用单个域名检测IoT设备，可能会导致识别共享DNS行为（例，来自同一供应商的不同设备型号）的设备产生严重混淆</li>
</ul>
</li>
</ul>
</li>
<li><p>因此本文想法：</p>
<ul>
<li>组合域名，以及不同IoT设备发出DNS查询的频率通常是具体的。这一观察结果有利于构建</li>
<li>一组有区别的行为指纹，可识别不同IoT设备模型，并当与普通客户端DNS行为匹配时，不易触发大量误报。</li>
<li>利用该直觉构建一个系统<ul>
<li>自动学习基于DNS的IoT指纹，</li>
<li>无需对查询域名格式严格假设</li>
<li>无需手动推导过滤启发式减少误报</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="方法概述"><a href="#方法概述" class="headerlink" title="方法概述"></a>方法概述</h3><p>构建高效的基于DNS的IoT设备指纹，将IoT设备检测和文档检索进行类比【20】</p>
<ul>
<li>名称表示<ul>
<li>$C_i$表示通用设备（IoT或非IoT），实践中由设备的IP(v4或v6)地址表示</li>
<li>$d_{ij}$是设备$C_i$查询的域名</li>
<li>$f_{ij}$是$d_{ij}$在$C_i$的DNS流量中出现的频率</li>
</ul>
</li>
</ul>
<p>我们把$C_i={(d_{ij},f_{ij})}<em>j$视为包含一组$d</em>{ij}$术语的文档，每个术语都有各自的术语频率$f_{ij}$</p>
<ul>
<li>名词表示<ul>
<li>$Q_k$为IoT设备</li>
<li>$q_{kj}$为$Q_k$查询的域名</li>
<li>$f_{kj}$为$Q_k$查询$q_{kj}$的频率</li>
</ul>
</li>
</ul>
<p>沿用文档检索的类比，将$Q_k={(q_{kj},f_{kj})}_j$作为搜索查询词，识别IoT设备的任务是：</p>
<blockquote>
<p>检索与搜索查询$Q_k$相似的所有文档$C_i$,并根据相似度排序</p>
</blockquote>
<p>根据类比，为了计算IoT设备$Q_k$的DNS行为与通用设备$C_i$的DNS行为之间的相似性</p>
<blockquote>
<p>首先将每个$Q_k$和$C_i$转换为各自的<strong>TF-IDF</strong>(即术语频率-逆文档频率)特征向量表示【20】，然后测量相似性（例，余弦相似性）在得到的特征向量之间。</p>
</blockquote>
<h4 id="B相关知识学习-2"><a href="#B相关知识学习-2" class="headerlink" title="B相关知识学习"></a>B相关知识学习</h4><h5 id="TF-IDF（术语频率-逆文档频率）"><a href="#TF-IDF（术语频率-逆文档频率）" class="headerlink" title="TF-IDF（术语频率-逆文档频率）"></a>TF-IDF（术语频率-逆文档频率）</h5><p>TF-IDF反映了在文档集合中一个单词对一个文档的重要性，经常在文本数据挖据与信息提取中用来作为权重因子</p>
<p><a href="词频-逆文档频率(TF-IDF).ipynb">参考TF-IDF</a></p>
<h4 id="面临挑战"><a href="#面临挑战" class="headerlink" title="面临挑战"></a>面临挑战</h4><p>主要有关IoT设备模型和文档检索之间的类比。</p>
<p>无论IoT设备是位于NAT后还是和其它设备一起，我们匹配IoT设备的目标都不能立即适合文档检索场景。</p>
<p>文档检索更青睐于单个主题的检索，相比于含多个主题的文档相比，不希望这不利于匹配托管于NAT后的IoT设备或者处于相同IP地址的（IoT或非IoT）<br>等等。。。</p>
<h2 id="系统详细设计"><a href="#系统详细设计" class="headerlink" title="系统详细设计"></a>系统详细设计</h2><img src="https://cdn.jsdelivr.net/gh/fishni/ImgHosting/Images/A01/201213paper04.png" width="500px">

<h3 id="基于DNS的IoT指纹学习"><a href="#基于DNS的IoT指纹学习" class="headerlink" title="基于DNS的IoT指纹学习"></a>基于DNS的IoT指纹学习</h3><p>为了模型化IoT设备的DNS行为，进行如下操作：</p>
<ul>
<li>$Q_k={q_{kj}}<em>{j=1}^{m_k}$，表示一个IoT设备在$T_l$时间内查询$m_k$个不同的域名$q</em>{kj}$</li>
<li>将$T_l$划分成长度为$w$且不重叠的时间窗口</li>
<li>$N_w=\frac{T_l}{w}$表示长度为$w$的时间窗口个数</li>
<li>给定$q_{kj}$，通过判断其是否在时间窗口中，$n_{q_{kj}}$表示在$N_w$个时间窗口，查询域名$q_{kj}$的次数</li>
<li>定义$p_{kj}=\frac{n_{q_{kj}}}{N_w}$，表示设备$Q_k$查询的域名$q_{kj}$在任意长度w的时间窗口内至少查询一次的概率</li>
<li>则每个IoT设备$Q_k$的统计指纹为$P_k={(q_{kj},p_{kj})}_{j=1}^{m_k}$</li>
</ul>
<p>建立查询频率和词频之间的映射取决于测试时考虑的流量窗口的长度</p>
<p>离散化时间处理过程能够弥补相同供应商和相同模型的IoT设备查询频率可能的短期变化</p>
<ul>
<li>例如，相同的IoT设备Ia 和Ib，Ia部署在缓存DNS转发器（例，NAT），Ib直接或者通过非缓存的中间盒设备连接到ISP network，两者的查询频率可能不同（由于处于不同的middlebox下）</li>
<li>设置w的长度超过DNS资源记录(例，A记录 或者AAAA记录)TTL，能够使得Ia和Ib的DNS缓存行为近似相等，使得查询频率近似相等</li>
</ul>
<p>这样更精确化的进行IoT指纹的匹配，后面讨论时间窗口w的取值</p>
<p>计算IDF：估计每个IoT查询的域在全局DNS 跟踪中的反向“流行度”</p>
<ul>
<li>$Q={q_i}_{i=1}^m$表示任意IoT设备查询的不同域名的集合</li>
<li>类似，$Q=\bigcup{q_{kj}}_{j=1}^{m_k}$</li>
<li>$T_p$表示被动DNS跟踪收集的观察时间</li>
<li>$N_c(q_i)$表示在$T_p$时间内查询域名$q_i\in Q$的客户端数，$N_c$表示在$T_p$时间内至少查询一个IoT域名的总的客户端数量</li>
<li>定义$IDF(q_i)=\log(1+\frac{N_c}{N_c(q_i)+1})$，也即表示有机会匹配一个IoT设备，域名$q_i$越少见，其逆文档频率越高（其特异性越高）</li>
</ul>
<p>实践中，从模型中筛选较为流行的域名。在文档检索类别中，过滤掉“stop word”域名，如过滤d域名（例：google.com）,过滤掉d和<a href="http://www.d" target="_blank" rel="noopener">www.d</a> 过滤目的：</p>
<ul>
<li>减少测试时要考虑匹配的客户端数量$C_i$，从而使指纹匹配更加高效</li>
<li>减少触发误报的概率，因为高度流行的域名被大多数非IoT设备查询，从而可能导致虚假匹配</li>
</ul>
<p>学习过程中，获得每个IoT设备的统计指纹，一个IoT设备指纹应包含内容：</p>
<ul>
<li>IoT域查询频率：对每个IoT设备$Q_k$， $P_k={(q_{kj},p_{kj})}_{j=1}^{m_k}$</li>
<li>用来计算$P_k$的时间窗口$w$</li>
<li>每个域的IDF值：${IDF(q_{kj})}_{j=1}^{m_k}$</li>
<li>基于每个设备的最大容许假阳性率$\phi$计算的探测阈值$\theta_k$</li>
</ul>
<h3 id="基于DNS的IoT指纹匹配"><a href="#基于DNS的IoT指纹匹配" class="headerlink" title="基于DNS的IoT指纹匹配"></a>基于DNS的IoT指纹匹配</h3><p>本节阐释基于DNS的IoT指纹如何与未来的被动DNS追踪进行匹配</p>
<p>相关名词：</p>
<ul>
<li>$T_t$作为被动观察DNS流量的时间窗口</li>
<li>$C_i$表示DNS流量中DNS查询的一个客户端</li>
</ul>
<p>我们目标：在指纹$P_k$和$C_i$的DNS行为之间，计算一个得分$s_{ki}$，</p>
<p>计算TF-IDF向量：</p>
<ul>
<li>计算时间窗口个数：$N_t=\lceil \frac{T_t}{w} \rceil$，其中$w$和学习$P_k$时使用的是相同的</li>
<li>设定$f_{kj}=p_{kj}*N_t$，则TF向量$V_k={(q_{kj},f_{kj})}<em>{j=1}^{m_k}$，$f</em>{kj}$表示的是在$T_t$时间内，IoT设备k查询域$q_{kj}$的时间窗口个数</li>
<li>最后，计算相应TF-IDF值$\psi_{kj}=f_{kj}*IDF(q_{kj})$</li>
<li>使用$\Psi_k={(q_{kj},\psi_{kj})}_{j=1}^{m_k}$表示时间$T_k$内IoT设备$Q_k$的TF-IDF向量</li>
</ul>
<p>计算客户端$C_i$的TF-IDF向量</p>
<ul>
<li>假定$C_i$在$T_t$时间内查询$n_i$个不同的域名$d_{ij}$及其发生的频率$f_{ij}$</li>
<li>即$C_i={(d_{ij},f_{ij})}<em>{j=1}^{n_i}$，其中$f</em>{ij}$是计算查询域名$d_{ij}$的时间窗口w的个数</li>
</ul>
<p>计算一个IoT的TF-IDF向量和一个客户端$C_i$之间的相似性</p>
<ul>
<li><p>将$C_i$映射到$\Psi_k$的$m_k$空间中，实际上，计算新向量$C_i’={(q_{kl},f_{kl}’)}_{l=1}^{m_k}$</p>
<ul>
<li>其中，${q_{kl}}_{l=1}^{m_k}$表示的是和$\Psi_k$相同的$m_k$域名集合</li>
</ul>
</li>
<li><p>若$q_{kl}=d_{ij}，则f_{kl}’=f_{ij}$</p>
</li>
<li><p>若没有域名$d_{ij}$匹配$q_{kl}，则f_{kl}’=0$</p>
</li>
<li><p>换种说法，也即是我们取所有由客户端$C_i$查询的域同时也被IoT设备查询的域。设置它们的TF值，以反映在时间Tt中$C_i$询问它们的频率。如果一个IoT设备$Q_k$查询的域不在$C_i$的行为中，设定他的频率为0</p>
</li>
</ul>
<ul>
<li>最后计算，TF-IDF向量$\Gamma_i={(q_{kl},\gamma_{kl})}<em>{l=1}^{m_k}$，其中$\gamma</em>{kl}=f_{kl}’ \cdot IDF(q_{kl})$</li>
</ul>
<p>这种将$C_i$的行为“投射”到$Q_k$的域名空间能够实现我们主要目标之一</p>
<ul>
<li>能够避免仅仅因为$C_i$表示共存于同一IP地址后面(例如，在NAT后面)的多个设备(可能包括几个其他物联网和非物联网设备)的DNS流量，而惩罚$Q_k$和$C_i$的相似性分数，</li>
</ul>
<p>现在拥有两个跨度相同的向量空间$\Psi_k$和$\Gamma_i$</p>
<ul>
<li>令$\psi=[\psi_{kj}]，\gamma=\gamma_{kj}$是包含$\Psi_k和\Gamma_i$的两个向量</li>
<li>计算匹配分数：$s(\Psi_k,\Gamma_i)=\frac{\psi \cdot \gamma}{||\psi||\cdot ||\gamma||}$(例，计算两者余弦相似度)</li>
<li>若$s(\Psi_k,\Gamma_i)\geq \theta_k$，就认为$C_i$的DNS行为匹配IoT设备$Q_k$，其中$\theta_k$是自动计算的阈值，将误报的数量限制在预定的最大值$\phi$</li>
</ul>
<h3 id="学习设备检测阈值"><a href="#学习设备检测阈值" class="headerlink" title="学习设备检测阈值"></a>学习设备检测阈值</h3><p>为了学习每个特定设备的检测阈值$\theta_k$，进行如下步骤</p>
<ul>
<li><p>收集大的数据集$D$(在训练中的未被看到，标记为被动DNS追踪)，实践中，$D$为我们提够了大量非IoT设备的流量记录，构成负面数据</p>
</li>
<li><p>在$D$中获取$C_i$的行为，并将其与之前学习的IoT指纹进行匹配</p>
</li>
<li><p>计算每个指纹和$D$中每个非IoT设备之间的余弦值$s(\Psi_k,\Gamma_i)$</p>
</li>
<li><p>调整检测阈值$\theta_k$计算假阳性的变化</p>
</li>
<li><p>同样，考虑IoT设备$Q_k$生成的未见过的DNS流量，使用该流量计算每个IoT设备指纹$\Psi_k$的真阳率</p>
</li>
</ul>
<p>给定最大容许假阳率$\phi$，目标找到检测阈值$\theta_k$，满足两个要求：</p>
<ul>
<li>指纹$\Psi_k$产生的假阳率$F_k\leq \phi$</li>
<li>保持$F_k\leq \phi$时，最大化真阳率</li>
</ul>
<p>ROC曲线图（随着检测阈值变化，真阳性率和假阳性率之间的权衡）</p>
<p>如图带有线性插值的ROC曲线</p>
<img src="https://cdn.jsdelivr.net/gh/fishni/ImgHosting/Images/A01/201213paper05.png" width="500px">

<img src="https://cdn.jsdelivr.net/gh/fishni/ImgHosting/Images/A01/201213paper06.png" width="500px">

<h3 id="IoT指纹部署"><a href="#IoT指纹部署" class="headerlink" title="IoT指纹部署"></a>IoT指纹部署</h3><p>本节讨论如何枚举野外IoT设备</p>
<p>由于计算量大的问题，为了解决这个问题，我们在一个大型Apache Spark集群中实现了我们的特征向量计算和指纹匹配，使得来自一个大型ISP的真实世界的DNS流量的N ×M指纹匹配计算时间减少到每天不到一个小时(详见第4节)。</p>
<h2 id="评估"><a href="#评估" class="headerlink" title="评估"></a>评估</h2><h3 id="B相关知识"><a href="#B相关知识" class="headerlink" title="B相关知识"></a>B相关知识</h3><p>DPI（Deep Packet Inspection）是一种基于数据包的深度检测技术，针对不同的网络应用层载荷（例如HTTP、DNS等）进行深度检测，通过对报文的有效载荷检测决定其合法性。</p>
<h2 id="相关工作"><a href="#相关工作" class="headerlink" title="相关工作"></a>相关工作</h2><ul>
<li><p>许多工作探索了使用网络流量分析来检测网络中的物联网设备或研究它们的行为[23]-[37]。</p>
</li>
<li><p>其中一些工作利用网络流量统计进行设备识别[23]-[25]或受损设备检测[26]-[28]</p>
</li>
<li><p>其他工作使用了对不同应用层协议的分析，如HTTP、Telnet、DNS等。，识别物联网设备[29]-[32]</p>
</li>
<li><p>此外，还提出了主动探测技术，通过扫描网络资产[28]、[33]或使用设备的媒体访问控制地址来识别供应商和产品类型[38]、[39]，从而识别物联网设备。</p>
</li>
</ul>
<p><strong>值得注意的是</strong>，这些作品中有许多需要访问物联网设备所在的本地网络，或者访问网络流，而在非常大的规模上收集这些网络流通常很昂贵。另一方面，我们专注于仅基于大规模被动DNS流量分析来高效检测物联网设备，因为全球分布式DNS流量通常更容易大规模收集(在某些情况下可以购买)</p>
<ul>
<li>最近的一些作品研究了物联网设备产生的域名系统流量的特征[35]，[36]，并讨论了相关的隐私含义[34]，[40]。最近，有两项工作考虑将DNS流量用于物联网设备检测[19]，[37]。据我们所知，[19]，[37]是最接近我们的工作</li>
</ul>
<p>在[19]中，作者使用域名查询和物联网设备联系的目的IP地址来构建设备检测系统。如第2.2节所述，郭等人[19]提出了一些手动设计的启发式方法来过滤掉可能引起误报的物联网查询域。例如，给定物联网设备查询的一组域，它们探测这些域以确定它们是否是“面向人类的”(即，它们是否包含人类可访问的内容)。此外，他们还会过滤掉不包含物联网设备供应商名称的域名。然而，如第2.2节所述，这种启发式方法可能会丢弃具有高度歧视性的域名，并可用于更准确地检测特定物联网设备的存在。更重要的是，[19]建议使用单一域名进行检测，这可能会在具有重叠DNS行为的设备(例如，来自同一供应商的不同设备型号)之间造成严重混淆。另一方面，IoTFinter并不依赖于上面提到的启发式，而是可以基于设备查询的域名组合自动学习物联网设备检测模型。此外，IoTFinter会自动学习每个统计物联网指纹的检测阈值，以便将可能的误报限制在所需的容许量内。</p>
<p>在构建了IoTFinter之后，我们意识到最近发表的一篇文章[37]也提出了使用TF-IDF来模拟由物联网设备生成的DNS流量。然而，[37]与我们的工作大不相同。首先，在[37]中提出的系统要求要分类的流量必须已知来自单个物联网设备。引用[37]:[检测]算法应仅在已知流量文档属于已知为物联网设备的设备时调用。”相反，IoTFinder不需要这种先验知识，即使物联网设备与许多其他物联网和非物联网设备共同托管在同一个IP地址后面(例如，在同一个NAT后面)，也能够检测到它们。其次，在[37]中，检测阈值必须由操作员手动设置，而我们设计了一个</p>
<p>一种算法，用于标记现实世界的非物联网流量，并自动学习每个设备模型的检测阈值，以达到预定的最大容许误报率。此外，[37]中介绍的检测管道依赖于WHOIS记录和x509证书来识别物联网设备的供应商。然而，在许多实际情况下，域名的所有者可能与供应商不同，例如当使用私有的WHOIS记录时，或者当服务托管在与云相关的域(例如AWS)上时。在这种情况下，设备最终可能会被分配给错误的供应商。这种错误的决定将级联到设备类型分类器，这依赖于供应商分类器的成功来进行正确的设备识别[37]。我们的工作不一样，因为我们只依靠DNS流量分析，对一个物联网设备查询的域名的归属不做任何假设。此外，我们专注于大规模检测，并实施IoTFinter，以有效检测托管数千万客户端的大型ISP网络中的许多不同物联网设备。</p>
<p>还有一项提议是通过自动域名注册来识别物联网设备[41]。然而，目前还不清楚这一提议在未来是否会被广泛采用，因为它需要物联网供应商的合作。此外，遗留物联网设备可能通过这种机制保持不可检测。另一方面，我们的系统不需要物联网供应商的合作，可以“原样”检测物联网设备，包括可能不支持未来协议的遗留设备。</p>
<h2 id="讨论和限制"><a href="#讨论和限制" class="headerlink" title="讨论和限制"></a>讨论和限制</h2><ul>
<li>DNS流量轻量，易收集，信息粒度低。</li>
<li>本文基于DNS的IoT指纹能够模拟IoT设备DNS行为，能够精确检测许多IoT设备（即是该IoT设备托管在NAT后还是和其它非IoT设备混杂一起）</li>
</ul>
<ul>
<li><p>某些情况下，基于DNS的流量模型无法捕捉同一供应商生产的不同设备之间的差异</p>
</li>
<li><p>同时，每当发现IoT指纹匹配通过相关检测阈值时，我们的系统不仅报告已经检测到设备，还报告具有什么相似性。因此，当相似性不相同时，它可以用作一种置信度得分，以便通过选择具有最高相似性的设备来消除不同设备的歧义。</p>
</li>
</ul>
<ul>
<li><p>当大量(例如，数百个)物联网和非物联网设备托管在同一IP之后(例如，在同一NAT之后)时，准确检测物联网设备变得越来越困难。尽管如此，我们表明，我们的统计指纹仍然能够正确检测各种各样的物联网设备，而不会出现误报，即使在这种具有挑战性的情况下也是如此</p>
</li>
<li><p>目前我们的系统无法识别一个域名系统测试背后有多少相同设备的实例。主要原因是域名系统缓存效果可能会“压缩”查询频率信息，从而难以识别表现出相同域名系统行为的设备的确切数量</p>
</li>
</ul>
<p>自然，我们的方法仅限于非加密的域名系统流量，因为我们需要访问查询的域名。最近，出现了使用DoH (RFC8484)或DoT (RFC7858)加密DNS流量的趋势。特别是，集中式DoH可能是一个问题，因为它可能会阻止本地网络运营商(包括互联网服务提供商)收集有关其客户端生成的域名系统流量的详细信息。然而，我们应该考虑一些观察结果。首先，DoH可能会对其他现有的安全应用程序产生负面影响，有人提议尝试防止这种情况[22]。其次，DoH目前大多局限于浏览器发布的DNS查询。因此，如果DoH成为主要浏览器的默认协议，物联网设备可能更容易检测到，因为它们的域名系统查询将与少量的非域名系统流量混合在一起。未来的物联网设备最终也可能开始采用DoH或DoT。然而，对于许多资源受限且不允许添加DNS加密软件的传统物联网设备来说，它们的DNS流量特征可能会变得越来越明显。最后，虽然采用DoH的新(或更新的)物联网设备可能会被直接的互联网服务提供商监控所隐藏，但我们的方法仍然有效，因为它可以由DoH运营商(如谷歌或Cloudflare)而不是单个互联网服务提供商来应用，以估计互联网上的物联网设备数量</p>

          
            <br>
            
  
    
    

<section class="widget copyright  desktop mobile">
  <div class='content'>
    
      <blockquote>
        
          
            <p>博客内容遵循 署名-非商业性使用-相同方式共享 4.0 国际 (CC BY-NC-SA 4.0) 协议</p>

          
        
          
            <p>本文永久链接是：<a href=https://fishni.github.io/2020/12/13/Paper-01-%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB/>https://fishni.github.io/2020/12/13/Paper-01-%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB/</a></p>
          
        
      </blockquote>
    
  </div>
</section>

  

  
    
    

<section class="widget qrcode  desktop mobile">
  

  <div class='content article-entry'>
    
      
        <div class='fancybox'><img src='https://cdn.jsdelivr.net/gh/fishni/ImgHosting/Images/A01/wechat.jpg'
        
          height='64px'
        ></div>
      
    
      
        <div class='fancybox'><img src='https://cdn.jsdelivr.net/gh/fishni/ImgHosting/Images/A01/qq.jpg'
        
          height='64px'
        ></div>
      
    
  </div>
</section>

  


          
        </div>
        
          


  <section class='meta' id="footer-meta">
    <div class='new-meta-box'>
      
        
          <div class="new-meta-item date" itemprop="dateUpdated" datetime="2020-12-14T09:50:04+08:00">
  <a class='notlink'>
    <i class="fas fa-edit fa-fw" aria-hidden="true"></i>
    <p>更新于：2020年12月14日</p>
  </a>
</div>

        
      
        
          
  
  <div class="new-meta-item meta-tags"><a class="tag" href="/tags/PapersReading/" rel="nofollow"><i class="fas fa-hashtag fa-fw" aria-hidden="true"></i><p>PapersReading</p></a></div>


        
      
        
          

        
      
        
          
  <div class="new-meta-item share -mob-share-list">
  <div class="-mob-share-list share-body">
    
      
        <a class="-mob-share-qq" title="" rel="external nofollow noopener noreferrer"
          
          href="http://connect.qq.com/widget/shareqq/index.html?url=https://fishni.github.io/2020/12/13/Paper-01-%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB/&title=【PapersReading】通过被动DNS流量分析识别大规模IoT设备 - fishni&summary=见下文。"
          
          >
          
            <img src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/logo/128/qq.png">
          
        </a>
      
    
      
        <a class="-mob-share-qzone" title="" rel="external nofollow noopener noreferrer"
          
          href="https://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url=https://fishni.github.io/2020/12/13/Paper-01-%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB/&title=【PapersReading】通过被动DNS流量分析识别大规模IoT设备 - fishni&summary=见下文。"
          
          >
          
            <img src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/logo/128/qzone.png">
          
        </a>
      
    
      
        <a class="-mob-share-weibo" title="" rel="external nofollow noopener noreferrer"
          
          href="http://service.weibo.com/share/share.php?url=https://fishni.github.io/2020/12/13/Paper-01-%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB/&title=【PapersReading】通过被动DNS流量分析识别大规模IoT设备 - fishni&summary=见下文。"
          
          >
          
            <img src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/logo/128/weibo.png">
          
        </a>
      
    
  </div>
</div>



        
      
    </div>
  </section>


        
        
          <div class="prev-next">
            
              <a class='prev' href='/2020/12/13/LeetCode-C-%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92-91.%20%E8%A7%A3%E7%A0%81%E6%96%B9%E6%B3%95/'>
                <p class='title'><i class="fas fa-chevron-left" aria-hidden="true"></i>【数据结构与算法】【LeetCode】【动态规划】91.解码方法</p>
                <p class='content'>dp数组，单变量

题目一条包含字母 A-Z 的消息通过以下方式进行了编码：
&apos;A&apos; -&gt; 1
&apos;B&apos; -&gt; 2
...
&apos;Z&ap...</p>
              </a>
            
            
              <a class='next' href='/2020/12/09/LeetCode-B-%E4%BA%8C%E5%8F%89%E6%A0%91-701.%20%E4%BA%8C%E5%8F%89%E6%90%9C%E7%B4%A2%E6%A0%91%E4%B8%AD%E7%9A%84%E6%8F%92%E5%85%A5%E6%93%8D%E4%BD%9C/'>
                <p class='title'>【数据结构与算法】【LeetCode】【二叉树】701.二叉搜索树中的插入操作<i class="fas fa-chevron-right" aria-hidden="true"></i></p>
                <p class='content'>二叉搜索查找，插入


题目给定二叉搜索树（BST）的根节点和要插入树中的值，将值插入二叉搜索树。 返回插入后二叉搜索树的根节点。 输入数据 保证 ，新值和原始二叉搜索树中的任意节点值都不同。
...</p>
              </a>
            
          </div>
        
      </section>
    </article>
  

  
    <!-- 显示推荐文章和评论 -->



  


  




<!-- 根据页面mathjax变量决定是否加载MathJax数学公式js -->

  <script async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<!-- MathJax配置，可通过单美元符号书写行内公式等 -->
<script>
window.MathJax = {
  tex: {
    inlineMath: [ ["$", "$"], ["\\(","\\)"] ],
    displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
    processEscapes: true,
    tags: "ams",
    macros: {
      href: "{}"
    }
  },
  options: {
    ignoreHtmlClass: "tex2jax_ignore|dno",
    skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
  }
};
</script>




  <script>
    window.subData = {
      title: '【PapersReading】通过被动DNS流量分析识别大规模IoT设备',
      tools: true
    }
  </script>


</div>
<aside class='l_side'>
  
  

  
    
    


  <section class="widget toc-wrapper shadow desktop mobile">
    
  <header>
    
      <i class="fas fa-list fa-fw" aria-hidden="true"></i><span class='name'>本文目录</span>
    
  </header>


    <div class='content'>
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#论文"><span class="toc-text">论文</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#论文摘要"><span class="toc-text">论文摘要</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#B相关知识学习"><span class="toc-text">B相关知识学习</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#被动DNS（Passive-DNS）"><span class="toc-text">被动DNS（Passive DNS）</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#介绍"><span class="toc-text">介绍</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#B相关知识学习-1"><span class="toc-text">B相关知识学习</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#banner-grabbing（横幅抓取）"><span class="toc-text">banner grabbing（横幅抓取）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#fingerprinting-指纹"><span class="toc-text">fingerprinting(指纹)</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#IoTFinder设计期望"><span class="toc-text">IoTFinder设计期望</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#本文贡献"><span class="toc-text">本文贡献</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#直觉和方法概述"><span class="toc-text">直觉和方法概述</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#IoT数据收集"><span class="toc-text">IoT数据收集</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#激励的示例"><span class="toc-text">激励的示例</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#方法概述"><span class="toc-text">方法概述</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#B相关知识学习-2"><span class="toc-text">B相关知识学习</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#TF-IDF（术语频率-逆文档频率）"><span class="toc-text">TF-IDF（术语频率-逆文档频率）</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#面临挑战"><span class="toc-text">面临挑战</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#系统详细设计"><span class="toc-text">系统详细设计</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#基于DNS的IoT指纹学习"><span class="toc-text">基于DNS的IoT指纹学习</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#基于DNS的IoT指纹匹配"><span class="toc-text">基于DNS的IoT指纹匹配</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#学习设备检测阈值"><span class="toc-text">学习设备检测阈值</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#IoT指纹部署"><span class="toc-text">IoT指纹部署</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#评估"><span class="toc-text">评估</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#B相关知识"><span class="toc-text">B相关知识</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#相关工作"><span class="toc-text">相关工作</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#讨论和限制"><span class="toc-text">讨论和限制</span></a></li></ol>
    </div>
  </section>


  


</aside>


  
  <footer class="clearfix">
    <br><br>
    
      
        <div class="aplayer-container">
          


        </div>
      
    
      
        <br>
        <div class="social-wrapper">
          
            
              <a href="https://fishni.github.io/"
                class="social fas fa-rss flat-btn"
                target="_blank"
                rel="external nofollow noopener noreferrer">
              </a>
            
          
            
          
            
              <a href="https://github.com/fishni"
                class="social fab fa-github flat-btn"
                target="_blank"
                rel="external nofollow noopener noreferrer">
              </a>
            
          
        </div>
      
    
      
        <div><p>博客内容遵循 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank" rel="noopener">署名-非商业性使用-相同方式共享 4.0 国际 (CC BY-NC-SA 4.0) 协议</a></p>
</div>
      
    
      
        本站使用
        <a href="https://volantis.js.org/" target="_blank" class="codename">fishni's blog</a>
        作为主题
        
          ，
          总访问量为
          <span id="busuanzi_value_site_pv"><i class="fas fa-spinner fa-spin fa-fw" aria-hidden="true"></i></span>
          次
        
      
    
      
        <div class='copyright'>
        <p><a href="https://fishni.github.io/">Copyright © 2017-2020 Mr.fishmouse</a></p>

        </div>
      
    
  </footer>

<script>setLoadingBarProgress(80);</script>


      <script>setLoadingBarProgress(60);</script>
    </div>
    <a class="s-top fas fa-arrow-up fa-fw" href='javascript:void(0)'></a>
  </div>
  
<script src="https://cdn.jsdelivr.net/npm/jquery@3.4/dist/jquery.min.js"></script>


  <script>
    
    var SEARCH_SERVICE = "hexo" || "hexo";
    var ROOT = "/" || "/";
    if (!ROOT.endsWith('/')) ROOT += '/';
  </script>


  <script async src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-volantis@2/js/instant_page.js" type="module" defer integrity="sha384-OeDn4XE77tdHo8pGtE1apMPmAipjoxUQ++eeJa6EtJCfHlvijigWiJpD7VDPWXV1"></script>



  
<script src="https://cdn.jsdelivr.net/npm/node-waves@0.7.6/dist/waves.min.js"></script>

  <script type="text/javascript">
    $(function() {
      Waves.attach('.flat-btn', ['waves-button']);
      Waves.attach('.float-btn', ['waves-button', 'waves-float']);
      Waves.attach('.float-btn-light', ['waves-button', 'waves-float', 'waves-light']);
      Waves.attach('.flat-box', ['waves-block']);
      Waves.attach('.float-box', ['waves-block', 'waves-float']);
      Waves.attach('.waves-image');
      Waves.init();
    });
  </script>


  <script async src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-busuanzi@2.3/js/busuanzi.pure.mini.js"></script>



  
  
  
    
<script src="https://cdn.jsdelivr.net/npm/jquery-backstretch@2.1.18/jquery.backstretch.min.js"></script>

    <script type="text/javascript">
      $(function(){
        var imgs=["https://cdn.jsdelivr.net/gh/fishni/ImgHosting/Images/A01/20210104eastandwest.gif"];
        if ('true' == 'true') {
          function shuffle(arr){
            /*From countercurrent-time*/
            var n = arr.length;
            while(n--) {
              var index = Math.floor(Math.random() * n);
              var temp = arr[index];
              arr[index] = arr[n];
              arr[n] = temp;
            }
          }
          shuffle(imgs);
        }
        if ('') {
          $('').backstretch(
            imgs,
          {
            duration: "20000",
            fade: "1500"
          });
        } else {
          $.backstretch(
            imgs,
          {
            duration: "20000",
            fade: "1500"
          });
        }
      });
    </script>
  












  
<script src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-volantis@2.2.1/js/app.js"></script>



  
<script src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-volantis@2.1/js/search.js"></script>



  
<script src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-volantis@2/js/comment_typing.js"></script>



<!-- 复制 -->

  <script src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js"></script>
<script>
  !function (e, t, a) {
    var initCopyCode = function(){
      var copyHtml = '';
      copyHtml += '<button class="btn-copy" data-clipboard-snippet="">';
      copyHtml += '<i class="fas fa-copy"></i><span>COPY</span>';
      copyHtml += '</button>';
      $(".highlight .code pre").before(copyHtml);
      var clipboard = new ClipboardJS('.btn-copy', {
        target: function(trigger) {
          return trigger.nextElementSibling;
        }
      });
      clipboard.on('success', function(e) {
        let $btn = $(e.trigger);
        $btn.addClass('copyed');
        let $icon = $($btn.find('i'));
        $icon.removeClass('fa-copy');
        $icon.addClass('fa-clipboard-check');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPYED';
      });
      clipboard.on('error', function(e) {
        e.clearSelection();
        let $btn = $(e.trigger);
        $btn.addClass('copy-failed');
        let $icon = $($btn.find('i'));
        $icon.removeClass('fa-copy');
        $icon.addClass('fa-exclamation-triangle');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPY FAILED';
      });
    }
    initCopyCode();
  }(window, document);
</script>




<!-- fancybox -->

  <script src="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script>
<script>
  let LAZY_LOAD_IMAGE = "";
  $(".article-entry").find("div.fancybox").find("img").each(function () {
      var element = document.createElement("a");
      $(element).attr("data-fancybox", "gallery");
      $(element).attr("href", $(this).attr("src"));
      /* 图片采用懒加载处理时,
       * 一般图片标签内会有个属性名来存放图片的真实地址，比如 data-original,
       * 那么此处将原本的属性名src替换为对应属性名data-original,
       * 修改如下
       */
       if (LAZY_LOAD_IMAGE) {
         $(element).attr("href", $(this).attr("data-original"));
       }
      $(this).wrap(element);
  });
</script>






  <script>setLoadingBarProgress(100);</script>
</body>
</html>
