<!DOCTYPE html>
<html>
<head hexo-theme='https://volantis.js.org/#'>
  <meta charset="utf-8">
  <!-- SEO相关 -->
  
    
  
  <!-- 渲染优化 -->
  <meta name="renderer" content="webkit">
  <meta name="force-rendering" content="webkit">
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
  <meta name="HandheldFriendly" content="True" >
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <!-- 页面元数据 -->
  
    <title>【Crypto-CTF】Crpyto-RSA大整数分解-LineCTF2021-babycrypto3 - fishni</title>
  
    <meta name="keywords" content="python,密码学,Crypto-CTF,RSA">
  
  
    <meta name="description" content="之前做LineCTF2021-babycrypto3题时，知道明显是RSA的大整数分解，使用了各种方式，未果，事后了解到GGNFS和MSIEVE分解因数本文就各种可能状况的分解进行简单介绍，并详细介绍一些工具的安装使用，以及针对带有pub.pem的公钥文件的RSA题进行简单总结">
  

  <!-- feed -->
  

  <!-- import meta -->
  

  <!-- link -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.12.1/css/all.min.css">
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css">

  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-waves@0.7.6/dist/waves.min.css">

  

  
  <link rel="shortcut icon" type='image/x-icon' href="https://cdn.jsdelivr.net/gh/xaoxuu/assets@master/favicon/favicon.ico">
  

  

  <!-- import link -->
  

  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-volantis@2.2.1/css/style.css">

  

  <script>
    function setLoadingBarProgress(num) {
      document.getElementById('loading-bar').style.width=num+"%";
    }
  </script>

  
  
</head>

<body>
  
  <div id="loading-bar-wrapper">
  <div id="loading-bar"></div>
</div>
<header class="l_header shadow blur">

  <div class='wrapper'>
    <div class='nav-sub'>
      <a class="logo flat-box"></a>
      <ul class='switcher h-list'>
        <li><a class="s-comment flat-btn fas fa-comments fa-fw" target="_self" href='javascript:void(0)'></a></li>
        
          <li><a class="s-toc flat-btn fas fa-list fa-fw" target="_self" href='javascript:void(0)'></a></li>
        
      </ul>
    </div>
		<div class="nav-main">
      
        
        <a class="logo flat-box" target="_self" href='/'>
          
          
          
          
            FISHNI'S BLOG <b><sup style='color:#3AA757'></sup></b>
          
        </a>
      

      

			<div class='menu navigation'>
				<ul class='h-list'>
          
          
          
            
            
              <li>
                <a class="flat-box" href=/
                  
                  
                  
                    id="home"
                  >
                  
                    <i class='fas fa-rss fa-fw'></i>
                  
                  主页
                </a>
                
              </li>
            
          
          
            
            
              <li>
                <a class="flat-box" href=/categories/
                  
                  
                  
                    id="categories"
                  >
                  
                    <i class='fas fa-folder-open fa-fw'></i>
                  
                  分类
                </a>
                
              </li>
            
          
          
            
            
              <li>
                <a class="flat-box" href=/tags/
                  
                  
                  
                    id="tags"
                  >
                  
                    <i class='fas fa-tags fa-fw'></i>
                  
                  标签
                </a>
                
              </li>
            
          
          
            
            
              <li>
                <a class="flat-box" href=/archives/
                  
                  
                  
                    id="archives"
                  >
                  
                    <i class='fas fa-archive fa-fw'></i>
                  
                  归档
                </a>
                
              </li>
            
          
          
            
            
              <li>
                <a class="flat-box" href=/
                  
                  
                  
                    id="home"
                  >
                  
                    <i class='fas fa-info-circle fa-fw'></i>
                  
                  更多
                </a>
                
              </li>
            
          
          
				</ul>
			</div>

      
        <div class="m_search">
          <form name="searchform" class="form u-search-form">
            <i class="icon fas fa-search fa-fw"></i>
            <input type="text" class="input u-search-input" placeholder="搜索" />
          </form>
        </div>
      

			<ul class='switcher h-list'>
				
					<li><a class="s-search flat-btn fas fa-search fa-fw" target="_self" href='javascript:void(0)'></a></li>
				
				<li><a class="s-menu flat-btn fas fa-bars fa-fw" target="_self" href='javascript:void(0)'></a></li>
			</ul>
		</div>
	</div>
</header>
<ul class="menu-phone navigation white-box">
  
  
    <li>
      <a class="flat-box" href=/
        
        
        
          id="home"
        >
        
          <i class='fas fa-rss fa-fw'></i>
        
        主页
      </a>
    </li>
  
    <li>
      <a class="flat-box" href=/categories/
        
        
        
          id="categories"
        >
        
          <i class='fas fa-folder-open fa-fw'></i>
        
        分类
      </a>
    </li>
  
    <li>
      <a class="flat-box" href=/tags/
        
        
        
          id="tags"
        >
        
          <i class='fas fa-tags fa-fw'></i>
        
        标签
      </a>
    </li>
  
    <li>
      <a class="flat-box" href=/archives/
        
        
        
          id="archives"
        >
        
          <i class='fas fa-archive fa-fw'></i>
        
        归档
      </a>
    </li>
  
</ul>
<script>setLoadingBarProgress(40);</script>



  <div class="l_body nocover">
    <div class='body-wrapper'>
      

<div class='l_main'>
  

  
    <article id="post" class="post white-box shadow article-type-post" itemscope itemprop="blogPost">
      


  <section class='meta'>
    
    
    <div class="meta" id="header-meta">
      
        
  
    <h1 class="title">
      <a href="/2021/03/24/Crypto-04-RSA%E5%A4%A7%E6%95%B4%E6%95%B0%E5%88%86%E8%A7%A3-LineCTF2021-babycrypto3/">
        【Crypto-CTF】Crpyto-RSA大整数分解-LineCTF2021-babycrypto3
      </a>
    </h1>
  


      
      <div class='new-meta-box'>
        
          
        
          
            
<div class='new-meta-item author'>
  <a href="https://fishni.github.io/" rel="nofollow">
    <img src="https://cdn.jsdelivr.net/gh/fishni/ImgHosting/Images/A01/ghost1.jpg">
    <p>fishni</p>
  </a>
</div>

          
        
          
            
  
  <div class='new-meta-item category'>
    <a href='/categories/%E5%AF%86%E7%A0%81%E5%AD%A6/' rel="nofollow">
      <i class="fas fa-folder-open fa-fw" aria-hidden="true"></i>
      <p>密码学</p>
    </a>
  </div>


          
        
          
            <div class="new-meta-item date">
  <a class='notlink'>
    <i class="fas fa-calendar-alt fa-fw" aria-hidden="true"></i>
    <p>发布于：2021年3月24日</p>
  </a>
</div>

          
        
          
            

          
        
      </div>
      
        <hr>
      
    </div>
  </section>


      <section class="article typo">
        <div class="article-entry" itemprop="articleBody">
          
          <p>之前做LineCTF2021-babycrypto3题时，知道明显是RSA的大整数分解，使用了各种方式，未果，事后了解到<strong>GGNFS和MSIEVE</strong>分解因数<br>本文就各种可能状况的分解进行简单介绍，并详细介绍一些工具的安装使用，以及针对带有<code>pub.pem</code>的公钥文件的RSA题进行简单总结</p>
<a id="more"></a>

<h1>Table of Contents<span class="tocSkip"></span></h1>
<div class="toc"><ul class="toc-item"><li><span><a href="#RSA整数分解场景" data-toc-modified-id="RSA整数分解场景-1"><span class="toc-item-num">1&nbsp;&nbsp;</span>RSA整数分解场景</a></span><ul class="toc-item"><li><span><a href="#n较小，直接分解几种算法" data-toc-modified-id="n较小，直接分解几种算法-1.1"><span class="toc-item-num">1.1&nbsp;&nbsp;</span>n较小，直接分解几种算法</a></span><ul class="toc-item"><li><span><a href="#短除法" data-toc-modified-id="短除法-1.1.1"><span class="toc-item-num">1.1.1&nbsp;&nbsp;</span>短除法</a></span></li><li><span><a href="#Miller-Rabin素性测试和离散对数Pollard_rho分解" data-toc-modified-id="Miller-Rabin素性测试和离散对数Pollard_rho分解-1.1.2"><span class="toc-item-num">1.1.2&nbsp;&nbsp;</span>Miller-Rabin素性测试和离散对数Pollard_rho分解</a></span></li></ul></li><li><span><a href="#n较大，在线查找" data-toc-modified-id="n较大，在线查找-1.2"><span class="toc-item-num">1.2&nbsp;&nbsp;</span>n较大，在线查找</a></span></li><li><span><a href="#Wiener's-attack" data-toc-modified-id="Wiener's-attack-1.3"><span class="toc-item-num">1.3&nbsp;&nbsp;</span>Wiener's attack</a></span><ul class="toc-item"><li><span><a href="#适用情况" data-toc-modified-id="适用情况-1.3.1"><span class="toc-item-num">1.3.1&nbsp;&nbsp;</span>适用情况</a></span></li><li><span><a href="#简单介绍" data-toc-modified-id="简单介绍-1.3.2"><span class="toc-item-num">1.3.2&nbsp;&nbsp;</span>简单介绍</a></span></li><li><span><a href="#代码" data-toc-modified-id="代码-1.3.3"><span class="toc-item-num">1.3.3&nbsp;&nbsp;</span>代码</a></span></li></ul></li><li><span><a href="#费马分解" data-toc-modified-id="费马分解-1.4"><span class="toc-item-num">1.4&nbsp;&nbsp;</span>费马分解</a></span><ul class="toc-item"><li><span><a href="#适用情况" data-toc-modified-id="适用情况-1.4.1"><span class="toc-item-num">1.4.1&nbsp;&nbsp;</span>适用情况</a></span></li><li><span><a href="#代码示例" data-toc-modified-id="代码示例-1.4.2"><span class="toc-item-num">1.4.2&nbsp;&nbsp;</span>代码示例</a></span></li></ul></li></ul></li><li><span><a href="#GGNFS和MSIEVE分解" data-toc-modified-id="GGNFS和MSIEVE分解-2"><span class="toc-item-num">2&nbsp;&nbsp;</span>GGNFS和MSIEVE分解</a></span><ul class="toc-item"><li><span><a href="#windows下安装" data-toc-modified-id="windows下安装-2.1"><span class="toc-item-num">2.1&nbsp;&nbsp;</span>windows下安装</a></span><ul class="toc-item"><li><span><a href="#ECM在线和windows下yafu分解测试" data-toc-modified-id="ECM在线和windows下yafu分解测试-2.1.1"><span class="toc-item-num">2.1.1&nbsp;&nbsp;</span>ECM在线和windows下yafu分解测试</a></span></li><li><span><a href="#下载msieve" data-toc-modified-id="下载msieve-2.1.2"><span class="toc-item-num">2.1.2&nbsp;&nbsp;</span>下载msieve</a></span></li><li><span><a href="#下载ggnfs" data-toc-modified-id="下载ggnfs-2.1.3"><span class="toc-item-num">2.1.3&nbsp;&nbsp;</span>下载ggnfs</a></span></li><li><span><a href="#修改factmsieve.py文件" data-toc-modified-id="修改factmsieve.py文件-2.1.4"><span class="toc-item-num">2.1.4&nbsp;&nbsp;</span>修改factmsieve.py文件</a></span></li><li><span><a href="#多项式选择" data-toc-modified-id="多项式选择-2.1.5"><span class="toc-item-num">2.1.5&nbsp;&nbsp;</span>多项式选择</a></span></li></ul></li><li><span><a href="#Linux下安装" data-toc-modified-id="Linux下安装-2.2"><span class="toc-item-num">2.2&nbsp;&nbsp;</span>Linux下安装</a></span></li></ul></li><li><span><a href="#题目-LineCTF2021-babycrypto3" data-toc-modified-id="题目-LineCTF2021-babycrypto3-3"><span class="toc-item-num">3&nbsp;&nbsp;</span>题目-LineCTF2021-babycrypto3</a></span></li><li><span><a href="#题解" data-toc-modified-id="题解-4"><span class="toc-item-num">4&nbsp;&nbsp;</span>题解</a></span><ul class="toc-item"><li><span><a href="#分析密文" data-toc-modified-id="分析密文-4.1"><span class="toc-item-num">4.1&nbsp;&nbsp;</span>分析密文</a></span></li><li><span><a href="#解析公钥文件" data-toc-modified-id="解析公钥文件-4.2"><span class="toc-item-num">4.2&nbsp;&nbsp;</span>解析公钥文件</a></span><ul class="toc-item"><li><span><a href="#方式1：OpenSSL软件" data-toc-modified-id="方式1：OpenSSL软件-4.2.1"><span class="toc-item-num">4.2.1&nbsp;&nbsp;</span>方式1：OpenSSL软件</a></span></li><li><span><a href="#方式2：Python库RSA" data-toc-modified-id="方式2：Python库RSA-4.2.2"><span class="toc-item-num">4.2.2&nbsp;&nbsp;</span>方式2：Python库RSA</a></span></li></ul></li><li><span><a href="#分解n" data-toc-modified-id="分解n-4.3"><span class="toc-item-num">4.3&nbsp;&nbsp;</span>分解n</a></span></li><li><span><a href="#解密" data-toc-modified-id="解密-4.4"><span class="toc-item-num">4.4&nbsp;&nbsp;</span>解密</a></span></li></ul></li><li><span><a href="#参考文献" data-toc-modified-id="参考文献-5"><span class="toc-item-num">5&nbsp;&nbsp;</span>参考文献</a></span></li></ul></div>
知道RSA算法的应该都知道公钥（n,e），如果能有效分解模数n，那么其私钥（d,p,q）我们就能获得，所以这时其就不具备安全性。但是当n为较大整数时,基于大整数分解困难，又能保证RSA是安全的。但是对大整数的分解一直被研究，相关算法有Pollard Rho算法、连分数算法（Continued fracion,CFRAC）、二次筛法（Quadratic Sieve,QS）、平方型分解法（SQUFOF）、椭圆曲线（ECM）和数域筛法（Number Field Sieve,NFS）等，有感兴趣的可以了解相关算法。根据参考文献【1】,目前有700多位（二进制）被分解，但耗时也是非常非常长的。

<p>之前做LineCTF2021-babycrypto3题时，知道明显是RSA的大整数分解，使用了各种方式，未果，事后了解到<strong>GGNFS和MSIEVE</strong>分解因数<br>本文就各种可能状况的分解进行简单介绍，并详细介绍一些工具的安装使用，以及针对带有<code>pub.pem</code>的公钥文件的RSA题进行简单总结</p>
<h1 id="RSA整数分解场景"><a href="#RSA整数分解场景" class="headerlink" title="RSA整数分解场景"></a>RSA整数分解场景</h1><p>假设我们从题目获得了公钥（N，e）和待解密的密文c，由RSA的加解密过程，我们知道，如果要解密密文，我们要得到e的逆元d，而d是要我们去求解的。</p>
<ul>
<li><p>若n较小，直接分解</p>
</li>
<li><p>若n较大，在线分解：<a href="http://factordb.com" target="_blank" rel="noopener">http://factordb.com</a></p>
</li>
<li><p>yafu工具分解<br>  适用情况：p和q相差较大或相差较小时，可快速分解</p>
</li>
<li><p>GGNFS和MSIEVE分解</p>
</li>
<li><p>可使用RsaCtfTool</p>
</li>
<li><p>一般题目中，若是可分解，使用yafu或者msieve即可分解。若是有迹可寻，也即特殊情况下，可使用相关脚本解</p>
</li>
</ul>
<h2 id="n较小，直接分解几种算法"><a href="#n较小，直接分解几种算法" class="headerlink" title="n较小，直接分解几种算法"></a>n较小，直接分解几种算法</h2><h3 id="短除法"><a href="#短除法" class="headerlink" title="短除法"></a>短除法</h3><ul>
<li>短除法1</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="string">"""短除法-1</span></span><br><span class="line"><span class="string">从i为2开始枚举，一直枚举到，</span></span><br><span class="line"><span class="string">一旦n % i == 0成立，则i为n的因子，</span></span><br><span class="line"><span class="string">然后进行n //= i使运行速度加快并使i为质数才可能有n % i == 0。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">复杂度：0（n^1/2）</span></span><br><span class="line"><span class="string">适用范围：n: 2-10^16</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">factorization</span><span class="params">(n)</span>:</span></span><br><span class="line">    i = <span class="number">2</span></span><br><span class="line">    ret = []</span><br><span class="line">    <span class="keyword">while</span> i * i &lt;= n:</span><br><span class="line">        <span class="keyword">while</span> n % i == <span class="number">0</span>:</span><br><span class="line">            ret.append(i)</span><br><span class="line">            n //= i</span><br><span class="line">        i += <span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> n &gt; <span class="number">1</span>:</span><br><span class="line">        ret.append(n)</span><br><span class="line">    <span class="keyword">return</span> ret</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    print(factorization(int(input())))</span><br></pre></td></tr></table></figure>

<pre><code>24
[2, 2, 2, 3]</code></pre><ul>
<li>短除法2</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="string">"""短除法2</span></span><br><span class="line"><span class="string">我们可以打表出2到n^1/2之间的质数再进行试除，这样在解决多个数的质因数分解时才会免除大部分合数的影响。</span></span><br><span class="line"><span class="string">用素数筛进行打表复杂度为O(n)，我们也只需要从2到n^1/2打表到即可。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">复杂度：0（n^1/2）</span></span><br><span class="line"><span class="string">适用范围：n 2-10^12</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line">pri = []</span><br><span class="line">MX = int(<span class="number">1e6</span>)</span><br><span class="line">isprime = [<span class="literal">True</span>] * MX</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">init</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">global</span> a, MX</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">2</span>, MX):</span><br><span class="line">        <span class="keyword">if</span> isprime[i]:</span><br><span class="line">            pri.append(i)</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> range(i + i, MX, i):</span><br><span class="line">                isprime[j] = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">factorization</span><span class="params">(n)</span>:</span></span><br><span class="line">    <span class="keyword">global</span> pri</span><br><span class="line">    ret = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> pri:</span><br><span class="line">        <span class="keyword">if</span> i * i &gt; n:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">while</span> n % i == <span class="number">0</span>:</span><br><span class="line">            ret.append(i)</span><br><span class="line">            n //= i</span><br><span class="line">    ret.append(n)</span><br><span class="line">    <span class="keyword">return</span> ret</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    init()</span><br><span class="line">    print(factorization(int(input())))</span><br></pre></td></tr></table></figure>

<pre><code>21
[3, 7]</code></pre><h3 id="Miller-Rabin素性测试和离散对数Pollard-rho分解"><a href="#Miller-Rabin素性测试和离散对数Pollard-rho分解" class="headerlink" title="Miller-Rabin素性测试和离散对数Pollard_rho分解"></a>Miller-Rabin素性测试和离散对数Pollard_rho分解</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">用Miller-Rabin素性测试和离散对数Pollard_rho算法进行大数因数分解：</span></span><br><span class="line"><span class="string">复杂度：0(n^1/4)</span></span><br><span class="line"><span class="string">适用范围：n 2-10^33</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> log, log10</span><br><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> Counter</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">gcd</span><span class="params">(x, y)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> x <span class="keyword">if</span> y == <span class="number">0</span> <span class="keyword">else</span> gcd(y, x % y)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fpow</span><span class="params">(a, x, n)</span>:</span></span><br><span class="line">	ans = <span class="number">1</span></span><br><span class="line">	<span class="keyword">while</span> x &gt; <span class="number">0</span>:</span><br><span class="line">		<span class="keyword">if</span> x &amp; <span class="number">1</span>:</span><br><span class="line">			ans = ans * a % n</span><br><span class="line">		a = a * a % n</span><br><span class="line">		x &gt;&gt;= <span class="number">1</span></span><br><span class="line">	<span class="keyword">return</span> ans</span><br><span class="line"></span><br><span class="line"><span class="comment"># there change the times of Rabin-Miller</span></span><br><span class="line">TIMES = <span class="number">10</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">is_prime</span><span class="params">(n)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">check</span><span class="params">(a, n, x, t)</span>:</span></span><br><span class="line">        ret = fpow(a, x, n)</span><br><span class="line">        last = ret</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, t):</span><br><span class="line">            ret = ret * ret % n</span><br><span class="line">            <span class="keyword">if</span> ret == <span class="number">1</span> <span class="keyword">and</span> last != <span class="number">1</span> <span class="keyword">and</span> last != n - <span class="number">1</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">            last = ret</span><br><span class="line">        <span class="keyword">if</span> ret != <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> isinstance(n, int):</span><br><span class="line">        <span class="keyword">raise</span> TypeError(str(n) + <span class="string">' is not an integer!'</span>)</span><br><span class="line">    <span class="keyword">if</span> n &lt;= <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">raise</span> ValueError(<span class="string">'%d &lt;= 0'</span> % n)</span><br><span class="line">    <span class="keyword">if</span> n <span class="keyword">in</span> &#123;<span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">11</span>&#125;:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> &#123;<span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">11</span>&#125;:</span><br><span class="line">        <span class="keyword">if</span> n % i == <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    x = n - <span class="number">1</span></span><br><span class="line">    t = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">not</span> x &amp; <span class="number">1</span>:</span><br><span class="line">        x &gt;&gt;= <span class="number">1</span></span><br><span class="line">        t += <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, TIMES):</span><br><span class="line">        a = random.randint(<span class="number">1</span>, n - <span class="number">2</span>)</span><br><span class="line">        <span class="keyword">if</span> check(a, n, x, t):</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">pollard_rho_2</span><span class="params">(n, c)</span>:</span></span><br><span class="line">    x = random.randint(<span class="number">0</span>, n)</span><br><span class="line">    i, k, y = <span class="number">1</span>, <span class="number">2</span>, x</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        i += <span class="number">1</span></span><br><span class="line">        x = (x * x) % n + c</span><br><span class="line">        d = gcd(y - x, n)</span><br><span class="line">        <span class="keyword">if</span> d != <span class="number">1</span> <span class="keyword">and</span> d != n:</span><br><span class="line">            <span class="keyword">return</span> d</span><br><span class="line">        <span class="keyword">if</span> y == x:</span><br><span class="line">            <span class="keyword">return</span> n</span><br><span class="line">        <span class="keyword">if</span> i == k:</span><br><span class="line">            y = x</span><br><span class="line">            k &lt;&lt;= <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">pollard_rho_1</span><span class="params">(n)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> isinstance(n, int):</span><br><span class="line">        <span class="keyword">raise</span> TypeError(str(n) + <span class="string">' is not an integer!'</span>)</span><br><span class="line">    <span class="keyword">if</span> n == <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">    <span class="keyword">if</span> is_prime(n):</span><br><span class="line">        <span class="keyword">return</span> [n]</span><br><span class="line">    ans = []</span><br><span class="line">    p = n</span><br><span class="line">    <span class="keyword">while</span> p &gt;= n:</span><br><span class="line">        p = pollard_rho_2(p, random.randint(<span class="number">1</span>, n - <span class="number">1</span>))</span><br><span class="line">    ans.extend(pollard_rho_1(p))</span><br><span class="line">    ans.extend(pollard_rho_1(n // p))</span><br><span class="line">    <span class="keyword">return</span> ans</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">factorization</span><span class="params">(n)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> Counter(pollard_rho_1(n))</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    n = int(input())</span><br><span class="line">    print(<span class="string">'len:'</span>, len(str(n)))</span><br><span class="line">    print(factorization(n))</span><br></pre></td></tr></table></figure>

<pre><code>33
len: 2
Counter({3: 1, 11: 1})</code></pre><h2 id="n较大，在线查找"><a href="#n较大，在线查找" class="headerlink" title="n较大，在线查找"></a>n较大，在线查找</h2><p>当n较大时，若用常用的工具无法分解，可利用在线网站：<a href="http://factordb.com" target="_blank" rel="noopener">http://factordb.com</a> </p>
<h2 id="Wiener’s-attack"><a href="#Wiener’s-attack" class="headerlink" title="Wiener’s attack"></a>Wiener’s attack</h2><h3 id="适用情况"><a href="#适用情况" class="headerlink" title="适用情况"></a>适用情况</h3><p>适用情况：e过大或过小。<br>在e过大或过小的情况下，可使用算法从e中快速推断出d的值。详细的算法原理可以阅读：低解密指数攻击<br><a href="https://www.tr0y.wang/2017/11/06/CTFRSA/index.html#%E4%BD%8E%E8%A7%A3%E5%AF%86%E6%8C%87%E6%95%B0%E6%94%BB%E5%87%BB" target="_blank" rel="noopener">https://www.tr0y.wang/2017/11/06/CTFRSA/index.html#%E4%BD%8E%E8%A7%A3%E5%AF%86%E6%8C%87%E6%95%B0%E6%94%BB%E5%87%BB</a></p>
<p>wiener’s attack代码参考：<a href="https://github.com/pablocelayes/rsa-wiener-attack" target="_blank" rel="noopener">https://github.com/pablocelayes/rsa-wiener-attack</a></p>
<p>下面内容摘自上面参考博客</p>
<h3 id="简单介绍"><a href="#简单介绍" class="headerlink" title="简单介绍"></a>简单介绍</h3><p><img src="https://cdn.jsdelivr.net/gh/fishni/ImgHosting/Images/A01/210324rsa01.png" alt=""></p>
<p><img src="https://cdn.jsdelivr.net/gh/fishni/ImgHosting/Images/A01/210324rsa02.png" alt=""></p>
<h3 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h3><ul>
<li>python2代码</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="comment"># 展开为连分数</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">continuedFra</span><span class="params">(x, y)</span>:</span></span><br><span class="line">    cF = []</span><br><span class="line">    <span class="keyword">while</span> y:</span><br><span class="line">        cF += [x / y]</span><br><span class="line">        x, y = y, x % y</span><br><span class="line">    <span class="keyword">return</span> cF</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Simplify</span><span class="params">(ctnf)</span>:</span></span><br><span class="line">    numerator = <span class="number">0</span></span><br><span class="line">    denominator = <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> ctnf[::<span class="number">-1</span>]:</span><br><span class="line">        numerator, denominator = denominator, x * denominator + numerator</span><br><span class="line">    <span class="keyword">return</span> (numerator, denominator)</span><br><span class="line"><span class="comment"># 连分数化简</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">calculateFrac</span><span class="params">(x, y)</span>:</span></span><br><span class="line">    cF = continuedFra(x, y)</span><br><span class="line">    cF = map(Simplify, (cF[<span class="number">0</span>:i] <span class="keyword">for</span> i <span class="keyword">in</span> xrange(<span class="number">1</span>, len(cF))))</span><br><span class="line">    <span class="keyword">return</span> cF</span><br><span class="line"><span class="comment"># 解韦达定理</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">solve_pq</span><span class="params">(a, b, c)</span>:</span></span><br><span class="line">    par = gmpy2.isqrt(b * b - <span class="number">4</span> * a * c)</span><br><span class="line">    <span class="keyword">return</span> (-b + par) / (<span class="number">2</span> * a), (-b - par) / (<span class="number">2</span> * a)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">wienerAttack</span><span class="params">(e, n)</span>:</span></span><br><span class="line">    <span class="keyword">for</span> (d, k) <span class="keyword">in</span> calculateFrac(e, n):</span><br><span class="line">        <span class="keyword">if</span> k == <span class="number">0</span>: <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">if</span> (e * d - <span class="number">1</span>) % k != <span class="number">0</span>: <span class="keyword">continue</span></span><br><span class="line">        phi = (e * d - <span class="number">1</span>) / k</span><br><span class="line">        p, q = solve_pq(<span class="number">1</span>, n - phi + <span class="number">1</span>, n)</span><br><span class="line">        <span class="keyword">if</span> p * q == n:</span><br><span class="line">            <span class="keyword">return</span> abs(int(p)), abs(int(q))</span><br><span class="line">    <span class="keyword">print</span> <span class="string">'not find!'</span></span><br><span class="line">time.clock()</span><br><span class="line">n = <span class="number">0x92411fa0c93c1b27f89e436d8c4698bcf554938396803a5b62bd10c9bfcbf85a483bd87bb2d6a8dc00c32d8a7caf30d8899d90cb8f5838cae95f7ff5358847db1244006c140edfcc36adbdcaa16cd27432b4d50d2348b5c15c209364d7914ef50425e4c3da07612cc34e9b93b98d394b43f3eb0a5a806c70f06697b6189606eb9707104a7b6ff059011bac957e2aae9ec406a4ff8f8062400d2312a207a9e018f4b4e961c943dfc410a26828d2e88b24e4100162228a5bbf0824cf2f1c8e7b915efa385efeb505a9746e5d19967766618007ddf0d99525e9a41997217484d64c6a879d762098b9807bee46a219be76941b9ff31465463981e230eecec69691d1</span></span><br><span class="line">e = <span class="number">0x6f6b385dd0f06043c20a7d8e5920802265e1baab9d692e7c20b69391cc5635dbcaae59726ec5882f168b3a292bd52c976533d3ad498b7f561c3dc01a76597e47cfe60614f247551b3dbe200e2196eaa001a1d183886eeacddfe82d80b38aea24de1a337177683ed802942827ce4d28e20efef92f38f1b1a18c66f9b45f5148cceabfd736de8ac4a49e63a8d35a83b664f9f3b00f822b6f11ff13257ee6e0c00ca5c98e661ea594a9e66f2bd56b33d9a13f5c997e67a37fcf9a0c7f04d119fe1ba261127357e64a4b069aefed3049c1c1fe4f964fd078b88bedd064abea385cfebd65e563f93c12d34eb6426e8aa321033cfd8fe8855b9e74d07fe4f9d70de46f</span></span><br><span class="line">c = <span class="number">0x558b353e0bff6f006eddf2ee35bf7114a60f22228462e0b6289bc9d824fa4d5988b68d41960b16f89bd33b7a51d5de6ad9afe9e1e5fa778d7d44f3df5b4b482c00913fc2fb78a3fb4714b651e6fde2df8f2adffd7c4a6a344d112938c1818cae8439615ac9dbe5ebf6d0ee4a672664f4067389e38eedc900d3874424a29234b1bbd736468506427d81bfa4080c1f114a9165feec1b5b721bafcdf33b4ce5b84881192d7b84246c73aca1e570e1805a522b3f0693590fb14a49bbdbf856155b4f37f3432532b9e9fe615d1f90011319d13de9c224c6f709b497538f705f95374172f7ee423ef0db6b3969ac4aab780d630d2bed75f140a276fddfccd224ee024</span></span><br><span class="line">print(<span class="string">'e'</span>,e,<span class="string">'n'</span>,n)</span><br><span class="line"></span><br><span class="line">p, q = wienerAttack(e, n)</span><br><span class="line"><span class="keyword">print</span> <span class="string">'[+]Found!'</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">'  [-]p ='</span>,p</span><br><span class="line"><span class="keyword">print</span> <span class="string">'  [-]q ='</span>,q</span><br><span class="line"><span class="keyword">print</span> <span class="string">'  [-]n ='</span>,p*q</span><br><span class="line">d = gmpy2.invert(e,(p<span class="number">-1</span>)*(q<span class="number">-1</span>))</span><br><span class="line"><span class="keyword">print</span> <span class="string">'  [-]d ='</span>, d</span><br><span class="line"><span class="keyword">print</span> <span class="string">'  [-]m is:'</span> + <span class="string">'&#123;:x&#125;'</span>.format(pow(c,d,n)).decode(<span class="string">'hex'</span>)</span><br><span class="line"><span class="keyword">print</span> <span class="string">'\n[!]Timer:'</span>, round(time.clock(),<span class="number">2</span>), <span class="string">'s'</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">'[!]All Done!'</span></span><br></pre></td></tr></table></figure>

<pre><code>(&apos;e&apos;, 14065324093316017945695720258347429532521523200228598193322667338820770590989154977786981894794588594064536009186732255775035804405327706425255296803855527639374329558376563095664859692148197185703687276097309462020144376262777557533944519562049109221719648126706993033163993490190085491702629251352329396471456129542825658446009162968346786594848548139595669836329358788165100849817671092568134531593182392252696719165573226130084180843486935720502707239300540428534291779101061922644007823991998086019198292035392258539304441052201138357754863223836486846439513422901513872417295274198920142360883876210212927825007L, &apos;n&apos;, 18462906143035540993814517057095163128283817787230664517838986634801013392767711846485937113330072380038567780269061919808605648774959966319179757205173372523095161810322702620470126948608656351385935375720727519176775110406692586449768317335765421930399299578230419560189633716571287406027463911286833332787737419540756653612611709926058384814812935770145166745335145087323852211057246522872067333040272572190577262813212787729743380140592301701193918348912668992966189995193003441075512789075254845693251194059243188025613215624222354768281910170062917473229700929505219308776883069798326608764552258161920559190481L)
[+]Found!
  [-]p = 104235442847969552884769987994197297422543352176802940317177677000499807722195632069286150361214879780730339973882703487096199834739930880687593938040395436586345480730212942206420793142692112306639438014319225266407401819137390988067078857106773391577174349673013152862143650835518682246788303050611999452911
  [-]q = 177126950666523578738984064380839651168608739644946060823792396091708111322051866642111785827074573440159197219479475538437582278979185941268904558179007415168216637577906599474105547898107223364283435084419522228187779674837611069387527478313869377950991632158274789401880909076604812300066218450595389655871
  [-]n = 18462906143035540993814517057095163128283817787230664517838986634801013392767711846485937113330072380038567780269061919808605648774959966319179757205173372523095161810322702620470126948608656351385935375720727519176775110406692586449768317335765421930399299578230419560189633716571287406027463911286833332787737419540756653612611709926058384814812935770145166745335145087323852211057246522872067333040272572190577262813212787729743380140592301701193918348912668992966189995193003441075512789075254845693251194059243188025613215624222354768281910170062917473229700929505219308776883069798326608764552258161920559190481
  [-]d = 42043
  [-]m is:flag{w13n3r_4tt4ck_d_1s_10w}

[!]Timer: 40.97 s
[!]All Done!</code></pre><h2 id="费马分解"><a href="#费马分解" class="headerlink" title="费马分解"></a>费马分解</h2><h3 id="适用情况-1"><a href="#适用情况-1" class="headerlink" title="适用情况"></a>适用情况</h3><p>当大整数N的两个因子p和q相近时，我们可以通过费马分解的办法很快分解大整数</p>
<h3 id="代码示例"><a href="#代码示例" class="headerlink" title="代码示例"></a>代码示例</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> isqrt <span class="keyword">import</span> isqrt</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fermat</span><span class="params">(n)</span>:</span></span><br><span class="line">    a = isqrt(n)</span><br><span class="line">    b2 = a * a - n</span><br><span class="line">    b = isqrt(n)</span><br><span class="line">    count = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> b * b != b2:</span><br><span class="line">        a = a + <span class="number">1</span></span><br><span class="line">        b2 = a * a - n</span><br><span class="line">        b = isqrt(b2)</span><br><span class="line">        count += <span class="number">1</span></span><br><span class="line">    p = a + b</span><br><span class="line">    q = a - b</span><br><span class="line">    <span class="keyword">assert</span> n == p * q</span><br><span class="line">    <span class="keyword">return</span> p, q</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    <span class="keyword">import</span> libnum</span><br><span class="line">    N=<span class="number">966808932627497190635859236054960349099463975227350564265384373280336699853387254070662881265937565163000758606154308757944030571837175048514574473061401566330836334647176655282619268592560172726526643074499534129878217409046045533656897050117438496357231575999185527675071002803951800635220029015932007465117818739948903750200830856115668691007706836952244842719419452946259275251773298338162389930518838272704908887016474007051397194588396039111216708866214614779627566959335170676055025850932631053641576566165694121420546081043285806783239296799795655191121966377590175780618944910532816988143056757054052679968538901460893571204904394975714081055455240523895653305315517745729334114549756695334171142876080477105070409544777981602152762154610738540163796164295222810243309051503090866674634440359226192530724635477051576515179864461174911975667162597286769079380660782647952944808596310476973939156187472076952935728249061137481887589103973591082872988641958270285169650803792395556363304056290077801453980822097583574309682935697260204862756923865556397686696854239564541407185709940107806536773160263764483443859425726953142964148216209968437587044617613518058779287167853349364533716458676066734216877566181514607693882375533</span></span><br><span class="line">    e=<span class="number">65537</span></span><br><span class="line">    c=<span class="number">168502910088858295634315070244377409556567637139736308082186369003227771936407321783557795624279162162305200436446903976385948677897665466290852769877562167487142385308027341639816401055081820497002018908896202860342391029082581621987305533097386652183849657065952062433988387640990383623264405525144003500286531262674315900537001845043225363148359766771033899680111076181672797077410584747509581932045540801777738548872747597899965366950827505529432483779821158152928899947837196391555666165486441878183288008753561108995715961920472927844877569855940505148843530998878113722830427807926679324241141182238903567682042410145345551889442158895157875798990903715105782682083886461661307063583447696168828687126956147955886493383805513557604179029050981678755054945607866353195793654108403939242723861651919152369923904002966873994811826391080318146260416978499377182540684409790357257490816203138499369634490897553227763563553981246891677613446390134477832143175248992161641698011195968792105201847976082322786623390242470226740685822218140263182024226228692159380557661591633072091945077334191987860262448385123599459647228562137369178069072804498049463136233856337817385977990145571042231795332995523988174895432819872832170029690848</span></span><br><span class="line">    p,q=fermat(N)</span><br><span class="line">    print(<span class="string">"p:"</span>,p)</span><br><span class="line">    print(<span class="string">"q:"</span>,q)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 根据p,q求phi_n也即N的欧拉函数值</span></span><br><span class="line">    phi_n=(p<span class="number">-1</span>)*(q<span class="number">-1</span>)</span><br><span class="line">    <span class="comment"># 求d</span></span><br><span class="line">    d= libnum.invmod(e,phi_n)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 用d解密</span></span><br><span class="line">    flag=libnum.n2s(pow(c,d,N))</span><br><span class="line">    print(flag)</span><br></pre></td></tr></table></figure>

<pre><code>p: 31093551302922880999883020803665536616272147022877428745314830867519351013248914244880101094365815998050115415308439610066700139164376274980650005150267949853671653233491784289493988946869396093730966325659249796545878080119206283512342980854475734097108975670778836003822789405498941374798016753689377992355122774401780930185598458240894362246194248623911382284169677595864501475308194644140602272961699230282993020507668939980205079239221924230430230318076991507619960330144745307022538024878444458717587446601559546292026245318907293584609320115374632235270795633933755350928537598242214216674496409625928997877221
q: 31093551302922880999883020803665536616272147022877428745314830867519351013248914244880101094365815998050115415308439610066700139164376274980650005150267949853671653233491784289493988946869396093730966325659249796545878080119206283512342980854475734097108975670778836003822789405498941374798016753689377992355122774401780930185598458240894362246194248623911382284169677595864501475308194644140602272961699230282993020507668939980205079239221924230430230318076991507619960330144745307022538024878444458717587446601559546292026245318907293584609320115374632235270795633933755350928537598242214216674496409625928797450473
flag{d1fference_between_p_And_q_1s_t00_5mall}</code></pre><h1 id="GGNFS和MSIEVE分解"><a href="#GGNFS和MSIEVE分解" class="headerlink" title="GGNFS和MSIEVE分解"></a>GGNFS和MSIEVE分解</h1><h2 id="windows下安装"><a href="#windows下安装" class="headerlink" title="windows下安装"></a>windows下安装</h2><p>官网：<a href="http://gilchrist.ca/jeff/factoring/nfs_beginners_guide_perl.html" target="_blank" rel="noopener">http://gilchrist.ca/jeff/factoring/nfs_beginners_guide_perl.html</a></p>
<p>以及翻译：<a href="https://bbs.pediy.com/thread-156206.htm" target="_blank" rel="noopener">https://bbs.pediy.com/thread-156206.htm</a></p>
<ul>
<li>使用Number Field Sieve（NFS）算法分解大于90位的数字，我们可使用GGNFS和MSIEVE软件工具来完成此任务。</li>
<li>对于小于90位的数字，应将二次筛（QS）与MSIEVE或YAFU之类的程序一起使用。</li>
<li>为要分解的数字大小选择一个合理的分解算法很重要。例如，下面的100位整数使用ECM算法花费了将近80天的时间，而GNFS仅需几个小时。同样，少数数据应使用除GNFS之外的其他因素（例如ECM或QS）进行分解。</li>
</ul>
<p>下面示例：如何使用通用数字字段筛（GNFS）和Brian Gladman的factmsieve.py python脚本同时使用ggnfs和msieve工具对以下100位整数进行因子分解：2881039827457895971881627053137530734638790825166127496066674320241571446494762386620429538</p>
<h3 id="ECM在线和windows下yafu分解测试"><a href="#ECM在线和windows下yafu分解测试" class="headerlink" title="ECM在线和windows下yafu分解测试"></a>ECM在线和windows下yafu分解测试</h3><ul>
<li>ECM在线分解大整数：<a href="https://www.alpertron.com.ar/ECM.HTM" target="_blank" rel="noopener">https://www.alpertron.com.ar/ECM.HTM</a><blockquote>
<p>ECM和SIQS（二次筛法）结合</p>
</blockquote>
</li>
</ul>
<p><img src="https://cdn.jsdelivr.net/gh/fishni/ImgHosting/Images/A01/210324rsa03.png" alt=""></p>
<p>在线ECM测试结果：2 881039 827457 895971 881627 053137 530734 638790 825166 127496 066674 320241 571446 494762 386620 429538（91个数字）= 2×59×107×283×100469 ×25212824 127811 771907 702100 117027 070259（38个数字）×318305309 664993 （42位数字）</p>
<p>用时：12m 21.4s</p>
<ul>
<li>yafu分解测试<blockquote>
<p>输入.yafu-x64.exe后回车再输入factor(number)</p>
</blockquote>
</li>
</ul>
<p><img src="https://cdn.jsdelivr.net/gh/fishni/ImgHosting/Images/A01/210324rsa04.png" alt=""></p>
<p>用时285.2031秒</p>
<h3 id="下载msieve"><a href="#下载msieve" class="headerlink" title="下载msieve"></a>下载msieve</h3><p>下载地址：<a href="https://sourceforge.net/projects/msieve/" target="_blank" rel="noopener">https://sourceforge.net/projects/msieve/</a></p>
<p>下载完后将其内容复制添加至ggnfs文件夹中</p>
<h3 id="下载ggnfs"><a href="#下载ggnfs" class="headerlink" title="下载ggnfs"></a>下载ggnfs</h3><ul>
<li>先下载：factmsieve.py<blockquote>
<p>参考链接：<a href="http://brg.a2hosted.com/oldsite/computing/factmsieve.py" target="_blank" rel="noopener">http://brg.a2hosted.com/oldsite/computing/factmsieve.py</a></p>
</blockquote>
</li>
</ul>
<ul>
<li>再下载ggnfs</li>
</ul>
<p>下载地址：<a href="https://sourceforge.net/projects/ggnfs/" target="_blank" rel="noopener">https://sourceforge.net/projects/ggnfs/</a></p>
<p>因为我的电脑是windows自动检测下载的exe文件，然后下载即可</p>
<p>下载完成ggnfs文件夹内容如下图：下载后并没有def-nm-params.txt和def-par.txt这两个文件<br>可从网站：<a href="https://github.com/MersenneForum/ggnfs/tree/master/bin" target="_blank" rel="noopener">https://github.com/MersenneForum/ggnfs/tree/master/bin</a> 中下载这两个文件</p>
<p><img src="https://cdn.jsdelivr.net/gh/fishni/ImgHosting/Images/A01/210324rsa05.png" alt=""></p>
<ul>
<li>创建一个工作目录C:xxxxxx\ggnfs\example</li>
</ul>
<h3 id="修改factmsieve-py文件"><a href="#修改factmsieve-py文件" class="headerlink" title="修改factmsieve.py文件"></a>修改factmsieve.py文件</h3><ul>
<li><p>使用notepad++修改factmsieve.py文件</p>
<p>  Change lines 63-64 from:</p>
<h1 id="Set-binary-directory-paths"><a href="#Set-binary-directory-paths" class="headerlink" title="Set binary directory paths"></a>Set binary directory paths</h1><p>  GGNFS_PATH = ‘C:/Users/brg\Documents/Visual Studio 2015/Projects/ggnfs/bin/x64/Release’<br>  MSIEVE_PATH = ‘C:/Users/brg/Documents/Visual Studio 2015/Projects/msieve/bin/x64/Release’</p>
<p>  to:</p>
<h1 id="Set-binary-directory-paths-1"><a href="#Set-binary-directory-paths-1" class="headerlink" title="Set binary directory paths"></a>Set binary directory paths</h1><p>  GGNFS_PATH = ‘../‘<br>  MSIEVE_PATH = ‘../‘</p>
</li>
</ul>
<ul>
<li>查看自己电脑的CPU核数，命令行输入 wmic ，再输入cpu get</li>
</ul>
<pre><code>C:\Users\xxx&gt;wmic
wmic:root\cli&gt;cpu get</code></pre><p>滑动底部得到，如图所示：<br><img src="https://cdn.jsdelivr.net/gh/fishni/ImgHosting/Images/A01/210324rsa06.png" alt=""></p>
<pre><code>修改67 from:
NUM_CPUS = 4
to 若你的CPU为双核，可选1或2；若为四核，则可选1,2,3,4
NUM_CPUS = 4</code></pre><ul>
<li><p>默认情况下，factmsieve.py将使用msieve进行多项式选择。普通用户应该保留这个设置。如果出于某些原因，你想使用pol51多项式选择工具更做下面更改</p>
<p>  change lines 89-90 from:<br>  USE_KLEINJUNG_FRANKE_PS = False<br>  USE_MSIEVE_POLY = True<br>  to:<br>  USE_KLEINJUNG_FRANKE_PS = True<br>  USE_MSIEVE_POLY = False</p>
</li>
<li><p>GPU</p>
<p>  如果您使用的是启用了 GPU 的 msieve 版本，并且希望使用 GPU 启用多项式选择，请修改第 70 行，确保它写着。<br>  USE_CUDA = True<br>  如果您没有使用GPU，请确保它写着:<br>  USE_CUDA = False</p>
<p>  在第104行，如果你使用的不是’msieve’，请确保你的msieve可执行文件被正确命名。我的是msieve153故这里改为msieve153<br>  MSIEVE = ‘msieve153’</p>
</li>
</ul>
<p>由于我的本机运行出错，故将CUDA设置False</p>
<p>进入下一步</p>
<h3 id="多项式选择"><a href="#多项式选择" class="headerlink" title="多项式选择"></a>多项式选择</h3><p>NFS算法采用了3个阶段的方法，首先是<strong>多项式选择，然后是筛分，最后是线性代数</strong>。 在分解开始之前，必须先选择一个多项式。<br>factmsieve.py脚本将运行适当的工具为你选择一个。</p>
<p>windows下在上面创建的example文件夹中，创建example.n文件，该文件内容为：<br>n:2881039827457895971881627053137530734638790825166127496066674320241571446494762386620442953820735453</p>
<p>windows在example工作目录运行：</p>
<pre><code>C:xxxx\ggnfs\example&gt; python ..\factmsieve.py example</code></pre><p>如下图：<br><img src="https://cdn.jsdelivr.net/gh/fishni/ImgHosting/Images/A01/210324rsa07.png" alt=""></p>
<p>至此windows下已安装完成</p>
<h2 id="Linux下安装"><a href="#Linux下安装" class="headerlink" title="Linux下安装"></a>Linux下安装</h2><p>下载msieve：<a href="https://github.com/MersenneForum/msieve" target="_blank" rel="noopener">https://github.com/MersenneForum/msieve</a><br>其中包含了gnfs我们就直接在该文件夹下,终端输入make all即可</p>
<p>我使用的是kail所以命令如下：</p>
<pre><code>root@kali:~/myctf/msieve# make all</code></pre><h1 id="题目-LineCTF2021-babycrypto3"><a href="#题目-LineCTF2021-babycrypto3" class="headerlink" title="题目-LineCTF2021-babycrypto3"></a>题目-LineCTF2021-babycrypto3</h1><p>Plesase decrypt and get flag.</p>
<p>Flag is LINECTF{<decryped text>} and<br>decrypted text is human-readable text.</p>
<ul>
<li>附件：ciphertext.txt和pub.pem</li>
</ul>
<h1 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h1><h2 id="分析密文"><a href="#分析密文" class="headerlink" title="分析密文"></a>分析密文</h2><ul>
<li>ciphertext.txt文件内容</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> open(<span class="string">'ciphertext.txt'</span>,<span class="string">'rb'</span>) <span class="keyword">as</span> f:</span><br><span class="line">    hex_c=f.read()</span><br><span class="line">print(hex_c)</span><br></pre></td></tr></table></figure>

<pre><code>b&apos;\x01\x14\x1fUxa\xaa\xb3C\x9b\xe1\xeb\x87\xa0\x12`\x156e\x8a\x05\xf4\xf3x\xf7\xb9\xda\xe5J\x08Cn\\C]V\xdd\x1bH\x96\xb74\xae\xcd\x83\x88A\xd5\x92&amp;&apos;</code></pre><ul>
<li>将字节转换为整数</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes, bytes_to_long</span><br><span class="line">cipher=bytes_to_long(hex_c)</span><br><span class="line">cipher</span><br></pre></td></tr></table></figure>




<pre><code>10879776433900426660843740332190892429769159527203392037251077478777616065501519198653853699716123394455804888854401574</code></pre><h2 id="解析公钥文件"><a href="#解析公钥文件" class="headerlink" title="解析公钥文件"></a>解析公钥文件</h2><h3 id="方式1：OpenSSL软件"><a href="#方式1：OpenSSL软件" class="headerlink" title="方式1：OpenSSL软件"></a>方式1：OpenSSL软件</h3><pre><code>命令：rsa -pubin -in pub.pem -text -modulus</code></pre><p>如图</p>
<p><img src="https://cdn.jsdelivr.net/gh/fishni/ImgHosting/Images/A01/210324rsa08.png" alt=""></p>
<h3 id="方式2：Python库RSA"><a href="#方式2：Python库RSA" class="headerlink" title="方式2：Python库RSA"></a>方式2：Python库RSA</h3><ul>
<li>获取公钥（e,n）</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"><span class="keyword">with</span> open(<span class="string">'pub.pem'</span>, <span class="string">'r'</span>) <span class="keyword">as</span> f:</span><br><span class="line">    pubkey=f.read()</span><br><span class="line">key = RSA.importKey(pubkey)</span><br><span class="line">e,n=key.e,key.n</span><br><span class="line">e,n</span><br></pre></td></tr></table></figure>




<pre><code>(65537,
 31864103015143373750025799158312253992115354944560440908105912458749205531455987590931871433911971516176954193675507337)</code></pre><h2 id="分解n"><a href="#分解n" class="headerlink" title="分解n"></a>分解n</h2><p>查看n的位数</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">len(bin(n))<span class="number">-2</span><span class="comment"># bit</span></span><br></pre></td></tr></table></figure>




<pre><code>394</code></pre><p>说明可分，首先在<a href="http://factordb.com" target="_blank" rel="noopener">http://factordb.com</a> 查找，比赛时是查不出来的，目前已经有提交给这个网站，故现在是可查的</p>
<p>由于本机线程过小，跑的时间过长就直接粘贴网址查询的p和q</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">p = <span class="number">291664785919250248097148750343149685985101</span></span><br><span class="line">q = <span class="number">109249057662947381148470526527596255527988598887891132224092529799478353198637</span></span><br></pre></td></tr></table></figure>

<h2 id="解密"><a href="#解密" class="headerlink" title="解密"></a>解密</h2><ul>
<li>由上文已知，n,e,p,q</li>
</ul>
<p>直接利用RSA加解密原理</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line">d= libnum.invmod(e,(p<span class="number">-1</span>)*(q<span class="number">-1</span>))</span><br><span class="line">m=pow(cipher,d,n)</span><br><span class="line">long_to_bytes(m)</span><br></pre></td></tr></table></figure>




<pre><code>b&apos;\x02`g\xff\x85\x1e\xcd\xcba\xe5\x0b\x83\xa5\x15\xe3\x00Q0xPU0lORyBUSEUgRElTVEFOQ0UuCg==\n&apos;</code></pre><ul>
<li>观察到有base64编码</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">print(base64.b64decode(<span class="string">'Q0xPU0lORyBUSEUgRElTVEFOQ0UuCg=='</span>.encode()))</span><br></pre></td></tr></table></figure>

<pre><code>b&apos;CLOSING THE DISTANCE.\n&apos;</code></pre><p>可知flag为：LINECTF{CLOSING THE DISTANCE.}</p>
<ul>
<li>完整代码</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes,bytes_to_long</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> open(<span class="string">'ciphertext.txt'</span>,<span class="string">'rb'</span>) <span class="keyword">as</span> f:</span><br><span class="line">    cipher=bytes_to_long(f.read())</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> open(<span class="string">'pub.pem'</span>,<span class="string">'r'</span>) <span class="keyword">as</span> fp:</span><br><span class="line">    key = RSA.importKey(fp.read())</span><br><span class="line">n,e = key.n,key.e</span><br><span class="line">print(n,e)</span><br><span class="line">p = <span class="number">291664785919250248097148750343149685985101</span></span><br><span class="line">q = <span class="number">109249057662947381148470526527596255527988598887891132224092529799478353198637</span></span><br><span class="line"><span class="comment"># 计算d</span></span><br><span class="line">d= libnum.invmod(e,(p<span class="number">-1</span>)*(q<span class="number">-1</span>))</span><br><span class="line">m =pow(cipher,d,n)</span><br><span class="line">print(long_to_bytes(m))</span><br></pre></td></tr></table></figure>

<pre><code>31864103015143373750025799158312253992115354944560440908105912458749205531455987590931871433911971516176954193675507337 65537
b&apos;\x02`g\xff\x85\x1e\xcd\xcba\xe5\x0b\x83\xa5\x15\xe3\x00Q0xPU0lORyBUSEUgRElTVEFOQ0UuCg==\n&apos;</code></pre><h1 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h1><ul>
<li><p>[1]王兴波,唐春明,李建辉.公钥密码体制中大整数分解算法研究[J].现代信息科技,2020,4(16):125-133.</p>
</li>
<li><p><a href="https://github.com/x-vespiary/writeup/blob/master/2021/03-line/crypto-babycrypto3.md" target="_blank" rel="noopener">https://github.com/x-vespiary/writeup/blob/master/2021/03-line/crypto-babycrypto3.md</a></p>
</li>
<li><p><a href="http://gilchrist.ca/jeff/factoring/nfs_beginners_guide.html" target="_blank" rel="noopener">http://gilchrist.ca/jeff/factoring/nfs_beginners_guide.html</a></p>
</li>
</ul>

          
            <br>
            
  
    
    

<section class="widget copyright  desktop mobile">
  <div class='content'>
    
      <blockquote>
        
          
            <p>博客内容遵循 署名-非商业性使用-相同方式共享 4.0 国际 (CC BY-NC-SA 4.0) 协议</p>

          
        
          
            <p>本文永久链接是：<a href=https://fishni.github.io/2021/03/24/Crypto-04-RSA%E5%A4%A7%E6%95%B4%E6%95%B0%E5%88%86%E8%A7%A3-LineCTF2021-babycrypto3/>https://fishni.github.io/2021/03/24/Crypto-04-RSA%E5%A4%A7%E6%95%B4%E6%95%B0%E5%88%86%E8%A7%A3-LineCTF2021-babycrypto3/</a></p>
          
        
      </blockquote>
    
  </div>
</section>

  

  
    
    

<section class="widget qrcode  desktop mobile">
  

  <div class='content article-entry'>
    
      
        <div class='fancybox'><img src='https://cdn.jsdelivr.net/gh/fishni/ImgHosting/Images/A01/wechat.jpg'
        
          height='64px'
        ></div>
      
    
      
        <div class='fancybox'><img src='https://cdn.jsdelivr.net/gh/fishni/ImgHosting/Images/A01/qq.jpg'
        
          height='64px'
        ></div>
      
    
  </div>
</section>

  


          
        </div>
        
          


  <section class='meta' id="footer-meta">
    <div class='new-meta-box'>
      
        
          <div class="new-meta-item date" itemprop="dateUpdated" datetime="2021-03-24T22:03:18+08:00">
  <a class='notlink'>
    <i class="fas fa-edit fa-fw" aria-hidden="true"></i>
    <p>更新于：2021年3月24日</p>
  </a>
</div>

        
      
        
          
  
  <div class="new-meta-item meta-tags"><a class="tag" href="/tags/python/" rel="nofollow"><i class="fas fa-hashtag fa-fw" aria-hidden="true"></i><p>python</p></a></div> <div class="new-meta-item meta-tags"><a class="tag" href="/tags/%E5%AF%86%E7%A0%81%E5%AD%A6/" rel="nofollow"><i class="fas fa-hashtag fa-fw" aria-hidden="true"></i><p>密码学</p></a></div> <div class="new-meta-item meta-tags"><a class="tag" href="/tags/Crypto-CTF/" rel="nofollow"><i class="fas fa-hashtag fa-fw" aria-hidden="true"></i><p>Crypto-CTF</p></a></div> <div class="new-meta-item meta-tags"><a class="tag" href="/tags/RSA/" rel="nofollow"><i class="fas fa-hashtag fa-fw" aria-hidden="true"></i><p>RSA</p></a></div>


        
      
        
          

        
      
        
          
  <div class="new-meta-item share -mob-share-list">
  <div class="-mob-share-list share-body">
    
      
        <a class="-mob-share-qq" title="" rel="external nofollow noopener noreferrer"
          
          href="http://connect.qq.com/widget/shareqq/index.html?url=https://fishni.github.io/2021/03/24/Crypto-04-RSA%E5%A4%A7%E6%95%B4%E6%95%B0%E5%88%86%E8%A7%A3-LineCTF2021-babycrypto3/&title=【Crypto-CTF】Crpyto-RSA大整数分解-LineCTF2021-babycrypto3 - fishni&summary=之前做LineCTF2021-babycrypto3题时，知道明显是RSA的大整数分解，使用了各种方式，未果，事后了解到GGNFS和MSIEVE分解因数本文就各种可能状况的分解进行简单介绍，并详细介绍一些工具的安装使用，以及针对带有pub.pem的公钥文件的RSA题进行简单总结"
          
          >
          
            <img src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/logo/128/qq.png">
          
        </a>
      
    
      
        <a class="-mob-share-qzone" title="" rel="external nofollow noopener noreferrer"
          
          href="https://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url=https://fishni.github.io/2021/03/24/Crypto-04-RSA%E5%A4%A7%E6%95%B4%E6%95%B0%E5%88%86%E8%A7%A3-LineCTF2021-babycrypto3/&title=【Crypto-CTF】Crpyto-RSA大整数分解-LineCTF2021-babycrypto3 - fishni&summary=之前做LineCTF2021-babycrypto3题时，知道明显是RSA的大整数分解，使用了各种方式，未果，事后了解到GGNFS和MSIEVE分解因数本文就各种可能状况的分解进行简单介绍，并详细介绍一些工具的安装使用，以及针对带有pub.pem的公钥文件的RSA题进行简单总结"
          
          >
          
            <img src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/logo/128/qzone.png">
          
        </a>
      
    
      
        <a class="-mob-share-weibo" title="" rel="external nofollow noopener noreferrer"
          
          href="http://service.weibo.com/share/share.php?url=https://fishni.github.io/2021/03/24/Crypto-04-RSA%E5%A4%A7%E6%95%B4%E6%95%B0%E5%88%86%E8%A7%A3-LineCTF2021-babycrypto3/&title=【Crypto-CTF】Crpyto-RSA大整数分解-LineCTF2021-babycrypto3 - fishni&summary=之前做LineCTF2021-babycrypto3题时，知道明显是RSA的大整数分解，使用了各种方式，未果，事后了解到GGNFS和MSIEVE分解因数本文就各种可能状况的分解进行简单介绍，并详细介绍一些工具的安装使用，以及针对带有pub.pem的公钥文件的RSA题进行简单总结"
          
          >
          
            <img src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/logo/128/weibo.png">
          
        </a>
      
    
  </div>
</div>



        
      
    </div>
  </section>


        
        
          <div class="prev-next">
            
              <a class='prev' href='/2021/03/25/LeetCode-H-%E6%90%9C%E7%B4%A2%E7%AE%97%E6%B3%95-78.%20%E5%AD%90%E9%9B%86/'>
                <p class='title'><i class="fas fa-chevron-left" aria-hidden="true"></i>【数据结构与算法】【LeetCode】【dfs+回溯】78.子集</p>
                <p class='content'>深度优先搜索、回溯、迭代


题目给你一个整数数组 nums ，数组中的元素互不相同 。返回该数组所有可能的子集（幂集）。
解集不能包含重复的子集。你可以按 任意顺序返回解集。
示例1：
输入：...</p>
              </a>
            
            
              <a class='next' href='/2021/03/23/LeetCode-H-%E6%90%9C%E7%B4%A2%E7%AE%97%E6%B3%95-51.%20N%20%E7%9A%87%E5%90%8E/'>
                <p class='title'>【数据结构与算法】【LeetCode】【dfs+回溯】51. N皇后<i class="fas fa-chevron-right" aria-hidden="true"></i></p>
                <p class='content'>深度优先搜索、回溯思想


题目n皇后问题研究的是如何将n个皇后放置在$n\times n$的棋盘上，并且使皇后彼此之间不能相互攻击。
给你一个整数n，返回所有不同的n皇后问题的解决方案。
每一...</p>
              </a>
            
          </div>
        
      </section>
    </article>
  

  
    <!-- 显示推荐文章和评论 -->



  


  




<!-- 根据页面mathjax变量决定是否加载MathJax数学公式js -->

  <script async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<!-- MathJax配置，可通过单美元符号书写行内公式等 -->
<script>
window.MathJax = {
  tex: {
    inlineMath: [ ["$", "$"], ["\\(","\\)"] ],
    displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
    processEscapes: true,
    tags: "ams",
    macros: {
      href: "{}"
    }
  },
  options: {
    ignoreHtmlClass: "tex2jax_ignore|dno",
    skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
  }
};
</script>




  <script>
    window.subData = {
      title: '【Crypto-CTF】Crpyto-RSA大整数分解-LineCTF2021-babycrypto3',
      tools: true
    }
  </script>


</div>
<aside class='l_side'>
  
  

  
    
    


  <section class="widget toc-wrapper shadow desktop mobile">
    
  <header>
    
      <i class="fas fa-list fa-fw" aria-hidden="true"></i><span class='name'>本文目录</span>
    
  </header>


    <div class='content'>
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#n较小，直接分解几种算法"><span class="toc-text">n较小，直接分解几种算法</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#短除法"><span class="toc-text">短除法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Miller-Rabin素性测试和离散对数Pollard-rho分解"><span class="toc-text">Miller-Rabin素性测试和离散对数Pollard_rho分解</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#n较大，在线查找"><span class="toc-text">n较大，在线查找</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Wiener’s-attack"><span class="toc-text">Wiener’s attack</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#适用情况"><span class="toc-text">适用情况</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#简单介绍"><span class="toc-text">简单介绍</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#代码"><span class="toc-text">代码</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#费马分解"><span class="toc-text">费马分解</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#适用情况-1"><span class="toc-text">适用情况</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#代码示例"><span class="toc-text">代码示例</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#windows下安装"><span class="toc-text">windows下安装</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#ECM在线和windows下yafu分解测试"><span class="toc-text">ECM在线和windows下yafu分解测试</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#下载msieve"><span class="toc-text">下载msieve</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#下载ggnfs"><span class="toc-text">下载ggnfs</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#修改factmsieve-py文件"><span class="toc-text">修改factmsieve.py文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#多项式选择"><span class="toc-text">多项式选择</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Linux下安装"><span class="toc-text">Linux下安装</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#分析密文"><span class="toc-text">分析密文</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#解析公钥文件"><span class="toc-text">解析公钥文件</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#方式1：OpenSSL软件"><span class="toc-text">方式1：OpenSSL软件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#方式2：Python库RSA"><span class="toc-text">方式2：Python库RSA</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#分解n"><span class="toc-text">分解n</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#解密"><span class="toc-text">解密</span></a></li></ol>
    </div>
  </section>


  


</aside>


  
  <footer class="clearfix">
    <br><br>
    
      
        <div class="aplayer-container">
          


        </div>
      
    
      
        <br>
        <div class="social-wrapper">
          
            
              <a href="https://fishni.github.io/"
                class="social fas fa-rss flat-btn"
                target="_blank"
                rel="external nofollow noopener noreferrer">
              </a>
            
          
            
          
            
              <a href="https://github.com/fishni"
                class="social fab fa-github flat-btn"
                target="_blank"
                rel="external nofollow noopener noreferrer">
              </a>
            
          
        </div>
      
    
      
        <div><p>博客内容遵循 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank" rel="noopener">署名-非商业性使用-相同方式共享 4.0 国际 (CC BY-NC-SA 4.0) 协议</a></p>
</div>
      
    
      
        本站使用
        <a href="https://volantis.js.org/" target="_blank" class="codename">fishni's blog</a>
        作为主题
        
          ，
          总访问量为
          <span id="busuanzi_value_site_pv"><i class="fas fa-spinner fa-spin fa-fw" aria-hidden="true"></i></span>
          次
        
      
    
      
        <div class='copyright'>
        <p><a href="https://fishni.github.io/">Copyright © 2017-2020 Mr.fishmouse</a></p>

        </div>
      
    
  </footer>

<script>setLoadingBarProgress(80);</script>


      <script>setLoadingBarProgress(60);</script>
    </div>
    <a class="s-top fas fa-arrow-up fa-fw" href='javascript:void(0)'></a>
  </div>
  
<script src="https://cdn.jsdelivr.net/npm/jquery@3.4/dist/jquery.min.js"></script>


  <script>
    
    var SEARCH_SERVICE = "hexo" || "hexo";
    var ROOT = "/" || "/";
    if (!ROOT.endsWith('/')) ROOT += '/';
  </script>


  <script async src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-volantis@2/js/instant_page.js" type="module" defer integrity="sha384-OeDn4XE77tdHo8pGtE1apMPmAipjoxUQ++eeJa6EtJCfHlvijigWiJpD7VDPWXV1"></script>



  
<script src="https://cdn.jsdelivr.net/npm/node-waves@0.7.6/dist/waves.min.js"></script>

  <script type="text/javascript">
    $(function() {
      Waves.attach('.flat-btn', ['waves-button']);
      Waves.attach('.float-btn', ['waves-button', 'waves-float']);
      Waves.attach('.float-btn-light', ['waves-button', 'waves-float', 'waves-light']);
      Waves.attach('.flat-box', ['waves-block']);
      Waves.attach('.float-box', ['waves-block', 'waves-float']);
      Waves.attach('.waves-image');
      Waves.init();
    });
  </script>


  <script async src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-busuanzi@2.3/js/busuanzi.pure.mini.js"></script>



  
  
  
    
<script src="https://cdn.jsdelivr.net/npm/jquery-backstretch@2.1.18/jquery.backstretch.min.js"></script>

    <script type="text/javascript">
      $(function(){
        var imgs=["https://cdn.jsdelivr.net/gh/fishni/ImgHosting/Images/A01/20718gongsenkui02.jpg"];
        if ('true' == 'true') {
          function shuffle(arr){
            /*From countercurrent-time*/
            var n = arr.length;
            while(n--) {
              var index = Math.floor(Math.random() * n);
              var temp = arr[index];
              arr[index] = arr[n];
              arr[n] = temp;
            }
          }
          shuffle(imgs);
        }
        if ('') {
          $('').backstretch(
            imgs,
          {
            duration: "20000",
            fade: "1500"
          });
        } else {
          $.backstretch(
            imgs,
          {
            duration: "20000",
            fade: "1500"
          });
        }
      });
    </script>
  












  
<script src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-volantis@2.2.1/js/app.js"></script>



  
<script src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-volantis@2.1/js/search.js"></script>



  
<script src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-volantis@2/js/comment_typing.js"></script>



<!-- 复制 -->

  <script src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js"></script>
<script>
  !function (e, t, a) {
    var initCopyCode = function(){
      var copyHtml = '';
      copyHtml += '<button class="btn-copy" data-clipboard-snippet="">';
      copyHtml += '<i class="fas fa-copy"></i><span>COPY</span>';
      copyHtml += '</button>';
      $(".highlight .code pre").before(copyHtml);
      var clipboard = new ClipboardJS('.btn-copy', {
        target: function(trigger) {
          return trigger.nextElementSibling;
        }
      });
      clipboard.on('success', function(e) {
        let $btn = $(e.trigger);
        $btn.addClass('copyed');
        let $icon = $($btn.find('i'));
        $icon.removeClass('fa-copy');
        $icon.addClass('fa-clipboard-check');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPYED';
      });
      clipboard.on('error', function(e) {
        e.clearSelection();
        let $btn = $(e.trigger);
        $btn.addClass('copy-failed');
        let $icon = $($btn.find('i'));
        $icon.removeClass('fa-copy');
        $icon.addClass('fa-exclamation-triangle');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPY FAILED';
      });
    }
    initCopyCode();
  }(window, document);
</script>




<!-- fancybox -->

  <script src="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script>
<script>
  let LAZY_LOAD_IMAGE = "";
  $(".article-entry").find("div.fancybox").find("img").each(function () {
      var element = document.createElement("a");
      $(element).attr("data-fancybox", "gallery");
      $(element).attr("href", $(this).attr("src"));
      /* 图片采用懒加载处理时,
       * 一般图片标签内会有个属性名来存放图片的真实地址，比如 data-original,
       * 那么此处将原本的属性名src替换为对应属性名data-original,
       * 修改如下
       */
       if (LAZY_LOAD_IMAGE) {
         $(element).attr("href", $(this).attr("data-original"));
       }
      $(this).wrap(element);
  });
</script>






  <script>setLoadingBarProgress(100);</script>
</body>
</html>
